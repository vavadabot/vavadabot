
<!doctype html>
<html lang="en">
<head>
  <link rel="icon" href="images/pgotonavkaldku.png" type="image/png">
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5, minimum-scale=0.5, user-scalable=yes" />
  <title>VAVADA BOT</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
  
  <style>
    :root{
      --bg-1: #0f1722; /* deep navy */
      --bg-2: #071027; /* darker */
      --card: rgba(255,255,255,0.03);
      --accent: linear-gradient(135deg,#2dd4bf 0%, #60a5fa 100%);
      --glass: rgba(255,255,255,0.04);
      --muted: rgba(255,255,255,0.55);
      --soft: rgba(255,255,255,0.06);
    }
    *{box-sizing:border-box}
    html,body{min-height:100vh; height:auto;}
    body{
      margin:0;
      font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: radial-gradient(1200px 500px at 10% 10%, rgba(32,58,84,0.35), transparent),
                  radial-gradient(800px 400px at 90% 90%, rgba(10,25,40,0.5), transparent),
                  linear-gradient(180deg,var(--bg-1),var(--bg-2));
      color:#e6eef8;
      padding:32px;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      overflow-x:visible;
      min-width:100vw;
    }

  
    /* Left area (main steps) */
    .card{
      min-width:920px;
      max-width:100vw;
      border-radius:9px;
      padding:10px;
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      box-shadow: 0 4px 10px rgba(2,6,23,0.3), inset 0 1px 0 rgba(255,255,255,0.02);
      backdrop-filter: blur(3px) saturate(110%);
      display:block;
      margin:0 0 24px 0;
      position:relative;
      z-index:1;
    
  width:420px;
  max-width:100%;
  border-radius:18px;
  padding:28px;
  background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  box-shadow: 0 10px 30px rgba(2,6,23,0.6), inset 0 1px 0 rgba(255,255,255,0.02);
  backdrop-filter: blur(6px) saturate(120%);
  display:grid;
  grid-template-columns: 1fr 380px;
  gap:22px;

    }

    .aside{
      padding:18px;
      border-radius:12px;
      background: linear-gradient(180deg, rgba(255,255,255,0.012), rgba(255,255,255,0.008));
      display:flex;
      flex-direction:column;
      gap:12px;
      align-items:flex-start;
    }

    header.site-head{
      display:flex;align-items:center;gap:14px;justify-content:space-between
    }
    .logo{
      display:flex;align-items:center;gap:12px
    }
    .badge{
      width:52px;height:52px;border-radius:10px;background:var(--accent);display:flex;align-items:center;justify-content:center;font-weight:800;color:#021225;box-shadow:0 6px 18px rgba(32,64,96,0.25)
    }
    h1{font-size:20px;margin:0}
    p.lead{margin:0;color:var(--muted);font-size:13px}

    /* Steps navigation */
    .steps{
      display:flex;gap:8px;align-items:center;margin-top:2px
    }
    .step-dot{width:10px;height:10px;border-radius:6px;background:var(--soft);opacity:0.6}
    .step-dot.active{background:linear-gradient(90deg,#7dd3fc,#7cffa0);opacity:1;box-shadow:0 6px 20px rgba(40,180,200,0.12)}
    .step-dot.hidden{display:none}

    /* Step content */
    .step{display:none;flex-direction:column;gap:12px}
    .step.active{display:flex}

    label{font-size:13px;color:var(--muted);display:block;margin-bottom:6px}
    input[type="text"], input[type="number"], select{
      background:transparent;border:1px solid rgba(255,255,255,0.06);padding:10px 12px;border-radius:10px;color:inherit;font-size:14px;outline:none
    }
    .row{display:flex;gap:12px;align-items:center}

    /* Amount controls */
    .amount-box{display:flex;gap:12px;align-items:center}
    .amount-input{width:150px}
    input[type=range]{-webkit-appearance:none;appearance:none;height:6px;border-radius:8px;background:linear-gradient(90deg,#2dd4bf,#60a5fa);outline:none}

    /* Buttons */
    .controls{display:flex;gap:10px;margin-top:auto}
  button{border:0;padding:10px 14px;border-radius:10px;font-weight:600;cursor:pointer;transition:transform 0.18s cubic-bezier(.2,.8,.2,1), background 0.22s;}
    /* Анимация увеличения и синий градиент для кнопок 'Далее', 'Назад', 'На главную' */
    button[data-next-to], button[data-back-to], button[data-back-home],
    #toNextFrom0, #toMainFrom4,
    #nextBtn,
    .controls button, /* для кнопок внутри .controls */
    .step button.btn-primary, .step button.btn-ghost {
      /* только если текст совпадает */
    }
    button[data-next-to]:hover, button[data-back-to]:hover, button[data-back-home]:hover,
    #toNextFrom0:hover, #toMainFrom4:hover,
    #nextBtn:hover,
    #backToMainFromAviator:hover,
    #backToBetFrom4:hover,
    .controls button:hover,
    button[data-btn-text="СОХРАНИТЬ"]:hover,
    button[data-btn-text="ПОЛУЧИТЬ СТУПЕНЬ"]:hover,
    button[data-btn-text="Очистить историю"]:hover {
      transform: scale(1.08);
      background: linear-gradient(90deg, #00d9ff, #0066ff) !important;
      color: #fff !important;
      box-shadow: 0 4px 18px rgba(0,153,255,0.18);
    }
    /* Для кнопок с нужным текстом, если вдруг не срабатыет по id/атрибуту */
    button:hover {
      /* Только если текст 'Далее', 'Назад', 'На главную' */
    }
    button:hover:after {
      content: attr(data-btn-text);
      display: none;
    }
    /* JS: добавить data-btn-text для нужных кнопок */
    .btn-primary{background:linear-gradient(90deg,#06b6d4,#60a5fa);color:#021225}
    .btn-ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted)}

    /* Aside widgets */
  .widget{width:100%;padding:12px;border-radius:10px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.015));border:1px solid rgba(255,255,255,0.02)}
  /* Скрыть виджет Баланс в aside */
  aside .widget:nth-child(2) { display: none !important; }
    .widget h3{margin:0 0 8px 0;font-size:13px}
    .balance-amount{font-weight:800;font-size:22px}

    /* Generator */
    .die{
      width:120px;height:120px;border-radius:16px;display:flex;align-items:center;justify-content:center;font-size:42px;font-weight:800;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));box-shadow:0 8px 30px rgba(2,6,23,0.5)
    }
    .history{max-height:120px;overflow:auto;padding-top:6px}
    .chip{display:inline-block;padding:6px 10px;border-radius:999px;background:rgba(255,255,255,0.03);margin:6px 6px 0 0;font-weight:600}

    /* Footer small */
    .foot{font-size:12px;color:var(--muted);text-align:center;margin-top:10px}

    @media(max-width:880px){
      .card{grid-template-columns:1fr;}
      .aside{order:2}
    }
    /* Стили для выпадающего списка */
  #gameSelect {
    background: linear-gradient(135deg, #0a1a3f, #112b57); /* тёмно-синий градиент */
    color: #ffffff;
    border: none;
    border-radius: 12px;
    padding: 10px 16px;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    appearance: none; /* убираем стандартную стрелку */
    outline: none;
    transition: all 0.4s ease;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.4);
  }

  /* Ховер и фокус */
  #gameSelect:hover,
  #gameSelect:focus {
    background: linear-gradient(135deg, #0f5132, #198754); /* зелёный градиент */
    transform: scale(1.03);
    box-shadow: 0 6px 14px rgba(0, 255, 100, 0.4);
  }

  /* Для <option> минимальные стили (ограничения браузеров) */
  #gameSelect option {
    background: #0a1a3f; /* fallback для списка */
    color: #fff;
    font-weight: 500;
    padding: 10px;
  }
/* Aviator bet widget - dark, compact */
.aviator-bet-widget{width:100%;max-width:520px;background:transparent;font-family:Inter,system-ui, -apple-system, 'Segoe UI', Roboto; color:#e6eef8}
.abw-toggle{display:inline-flex;background:#0b0b0b;padding:6px;border-radius:999px;gap:6px;margin:8px 0 12px 0;box-shadow:inset 0 1px 0 rgba(255,255,255,0.02)}
.abw-tab{background:transparent;border:0;color:#9aa6b8;padding:8px 14px;border-radius:999px;cursor:pointer;font-weight:600}
.abw-tab.active{background:linear-gradient(180deg,#1f2937,#111827);color:#fff;box-shadow:0 6px 18px rgba(0,0,0,0.6)}
.abw-main{display:flex;gap:14px;align-items:center}
.abw-left{display:flex;flex-direction:column;gap:10px;flex:1}
.abw-amount-control{display:flex;align-items:center;gap:10px}
.abw-circle{width:36px;height:36px;border-radius:999px;border:0;background:#0f1722;color:#cbd5e1;font-size:20px;font-weight:700;cursor:pointer;box-shadow:0 4px 8px rgba(2,6,23,0.6)}
.abw-amount-display{text-align:center;padding:6px 10px;border-radius:10px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));min-width:92px}
.abw-amount-value{font-size:18px;font-weight:800}
.abw-currency{font-size:12px;color:#94a3b8;margin-top:2px}

.abw-presets{display:flex;gap:8px;flex-wrap:wrap;margin-top:6px}
.abw-chip{background:rgba(255,255,255,0.03);border:0;padding:8px 12px;border-radius:999px;font-weight:700;cursor:pointer;color:#e6eef8;font-size:13px}

.abw-chip {
  transition: background 0.4s, color 0.2s, box-shadow 0.3s;
  position: relative;
  overflow: hidden;
  transition: background 0.4s, color 0.2s, box-shadow 0.3s, transform 0.18s cubic-bezier(.2,.8,.2,1);
}
.abw-chip:hover {
  background: linear-gradient(90deg, #00d9ff, #0066ff, #00d9ff);
  color: #fff;
  box-shadow: 0 2px 10px rgba(0,153,255,0.18);
  animation: abwChipBlueFlow 2.2s linear infinite;
  transform: scale(1.12);
}
/* Активный (выбранный) чип — потемневший синий градиент и чуть больше */
.abw-chip.active, .abw-chip:active {
  background: linear-gradient(90deg, #005fa3, #003366, #005fa3);
  color: #fff;
  box-shadow: 0 4px 16px rgba(0,80,180,0.22);
  transform: scale(1.14);
  animation: none;
  z-index: 1;
}
@keyframes abwChipBlueFlow {
  0% { background-position: 0% 50%; }
  100% { background-position: 100% 50%; }
}

.abw-action{width:220px}
#abwPlaceBtn{width:100%;padding:18px;border-radius:12px;border:0;background:#15a33a;color:#021225;font-weight:800;cursor:pointer;display:flex;flex-direction:column;align-items:center;justify-content:center;box-shadow:0 10px 24px rgba(6,110,50,0.18)}
.abw-btn-title{font-size:18px}
.abw-btn-amount{font-size:20px;margin-top:6px}
@media(max-width:720px){
  .abw-main{flex-direction:column;align-items:stretch}
  .abw-action{width:100%}
}
.abw-action{width:220px}
.wrap {
  width: 460px;
}
#abwPlaceBtn{
  width:100%;
  padding:18px;
  border-radius:12px;
  border:0;
  background:#15a33a;
  color:#021225;
  font-weight:800;
  cursor:pointer;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  box-shadow:0 10px 24px rgba(6,110,50,0.18);
  transition:all 0.3s ease;
  position:relative;
  overflow:hidden;
}

/* Зелёная анимация при наведении */


/* Красная кнопка после клика */
#abwPlaceBtn.clicked {
  background:linear-gradient(180deg,#ff1a1a,#cc0000);
  color:#fff;
  box-shadow:0 8px 20px rgba(255,0,0,0.4);
  animation:none; /* отключаем зелёный градиент */
}

/* Если кнопка уже красная, при hover она остаётся красной */
#abwPlaceBtn.clicked:hover {
  background:linear-gradient(180deg,#ff1a1a,#cc0000);
  animation:none;
}
:root{
--bg:#05060a; --card:#0b1220; --accent:#6ef0ff; --muted:#9aa4b2; --glass: rgba(255,255,255,0.04);
--glass-2: rgba(255,255,255,0.02);
}

#betMax {
  margin-right: 42px;
}

.coeff{
font-size:48px; font-weight:800; letter-spacing: -1px; line-height:1; font-family:Inter,Segoe UI,Roboto,Arial,sans-serif;
text-shadow: 0 6px 24px rgba(15,59,140,.18), 0 2px 8px rgba(6,26,84,.5);
color:linear-gradient(90deg,#fff,#bfeaff);
display:flex; align-items:baseline; gap:8px
}
.coeff .num{display:inline-block; min-width:160px; text-align:left}
.coeff .x{font-size:18px; color:rgba(230,238,248,.75); font-weight:600}


.meter{
width:120px; height:12px; background:linear-gradient(90deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01)); border-radius:999px; overflow:hidden; position:relative
}
.meter > i{position:absolute; left:0; top:0; bottom:0; width:0%; border-radius:inherit; background:linear-gradient(90deg,var(--accent-start), #29a1ff); box-shadow:0 6px 20px rgba(10,60,130,.25); transition:width .2s linear}


.controls{margin-top:16px; display:flex; gap:12px; align-items:center}


.btn{
appearance:none; border:0; padding:12px 18px; border-radius:12px; font-weight:700; cursor:pointer; min-width:210px; font-size:15px;
background:linear-gradient(180deg,var(--accent-start), var(--accent-end)); box-shadow:var(--glow);
color:white; transform:translateZ(0); transition:transform .12s ease, box-shadow .12s ease;
}
.btn:active{transform:translateY(2px) scale(.995)}
.btn[disabled]{opacity:.6; cursor:default}


.btn.pulse{position:relative; overflow:hidden}
.btn.pulse::after{
content:""; position:absolute; inset:0; transform:translateX(-110%); background:linear-gradient(90deg, rgba(255,255,255,0.06), rgba(255,255,255,0.12), rgba(255,255,255,0.06));
transition:transform .9s cubic-bezier(.2,.9,.2,1)
}
.btn.pulse.animate::after{ transform:translateX(110%) }


.small{font-size:12px; color:rgba(230,238,248,.65)}


/* sparkles */
.sparkle{position:absolute; width:8px; height:8px; border-radius:50%; background:var(--neon); box-shadow:0 6px 18px rgba(110,231,255,.15); opacity:0; pointer-events:none}


/* confetti */
.confetti-piece{position:absolute; width:8px; height:12px; transform-origin:center; opacity:0}


footer{margin-top:14px; color:rgba(230,238,248,.45); font-size:12px; text-align:center}


@media (max-width:420px){ .coeff .num{min-width:120px} }

#status {
  transform: translateX(-100px); /* часто надёжнее */
  /* или */
  position: relative;
  left: 66px;
}

.small status {
  margin-left: -100px;
}
.x {
  margin-left: -60px; /* сдвигаем влево */
  display: inline-block; /* делаем чтобы margin работал предсказуемо */
  
}
#restartGameBtn9x9 {
width:110px;
  height:110px;
  border-radius:50%;
  font-size:16px;
  margin:18px auto 0 auto;
  display:flex;
  align-items:center;
  justify-content:center;
}
/* Синий тёмный градиент при наведении на кнопки валюты */
.currency-btn:hover {
  background: linear-gradient(90deg, #0a1a3f 0%, #22304a 100%) !important;
  color: #fff !important;
  box-shadow: 0 2px 10px rgba(0,40,80,0.18);
  transform: scale(1.08);
  transition: all 0.18s cubic-bezier(.2,.8,.2,1);
}
  /* Добавим стиль для cancel-btn */
  .cancel-btn {
    background: linear-gradient(180deg,#ff1a1a,#cc0000) !important;
    color: #fff !important;
    border: 2px solid #ff6a6a !important;
    box-shadow: 0 14px 34px rgba(255,60,60,0.18) !important;
    transition: filter 0.18s, box-shadow 0.18s;
      font-size: 13px !important;
      padding: 8px 12px !important;
  }
  .cancel-btn:hover, .cancel-btn:active {
    filter: brightness(1.13) saturate(1.08);
    box-shadow: 0 0 0 4px #ff6a6a, 0 18px 44px 0 rgba(255,60,60,0.18), 0 14px 34px rgba(255,60,60,0.14);
    background: linear-gradient(180deg,#ff4a4a,#ff6a6a) !important;
  }
  </style>
</head>
<body>
  <div class="card">
    <div class="main">
      <header class="site-head">
  <div style="display:flex;gap:12px;align-items:center"><div class="badge">VB</div><div><h1 data-i18n="VAVADA BOT">VAVADA BOT</h1></div></div>
  <div style="text-align:right; margin-right: -400px;"><div style="font-size:13px;color:var(--muted)" data-i18n="Пользователь:">Пользователь:</div><div id="userDisplay" style="font-weight:700">—</div></div>
      </header>

      <div style="display:flex;align-items:center;justify-content:space-between">
        <div class="steps">
          <div class="step-dot active" data-step="0" title="Главная"></div>
          <!-- step 1..5: скрываются/показываются в зависимости от режима -->
          <div id="dot-1" class="step-dot hidden" data-step="1" title="Баланс (Chicken)"></div>
          <div id="dot-2" class="step-dot hidden" data-step="2" title="Chicken — Генератор"></div>

          <div id="dot-3" class="step-dot hidden" data-step="3" title="Aviator — вкладка 1"></div>
          <div id="dot-4" class="step-dot hidden" data-step="4" title="Aviator — вкладка 2"></div>
          <!-- Penalty точки удалены -->
          <!-- Turbo Mines вкладки -->
          <div id="dot-8" class="step-dot hidden" data-step="8" title="Turbo Mines — вкладка 1"></div>
          <div id="dot-9" class="step-dot hidden" data-step="9" title="Turbo Mines — вкладка 2"></div>
      <!-- STEP 8: Turbo Mines — вкладка 1 (пустая) -->
      <section class="step" id="step-8">
        <div style="max-width:340px;margin:0 auto;padding:24px 0 0 0;">
          <div style="margin-bottom:18px;text-align:center;color:#ffb86c;font-size:18px;font-weight:700;" data-i18n="Сетка">Сетка</div>
          <div id="gridBtns" style="display:flex;gap:10px;justify-content:center;margin-bottom:22px;">
            <button class="grid-btn" data-size="3">3x3</button>
            <button class="grid-btn" data-size="5">5x5</button>
            <button class="grid-btn" data-size="7">7x7</button>
            <button class="grid-btn" data-size="9">9x9</button>
          </div>

          <div style="margin-bottom:18px;text-align:center;color:#ffb86c;font-size:18px;font-weight:700;" data-i18n="Кол-во мин">Кол-во мин</div>
         <div style="display:flex;gap:6px;align-items:center;justify-content:center;margin-bottom:14px;max-width:180px;width:100%;margin-left:auto;margin-right:auto;overflow-x:auto;">
  <button id="minMinus" class="min-btn" style="padding:6px 8px;font-size:14px;">−</button>
  <span id="minCount" style="font-size:14px;font-weight:700;color:#fff;min-width:40px;max-width:80px;display:inline-block;text-align:center;overflow-x:auto;" data-i18n-placeholder="Введите мины ">Введите мины </span>
  <button id="minPlus" class="min-btn" style="padding:6px 8px;font-size:14px;">+</button>
</div>

          <div style="margin-bottom:18px; color:#ffb86c; font-size:18px; font-weight:700; display:flex; justify-content:center; align-items:center;">
            <span style="text-align:center; width:100%; margin-left:72px;" data-i18n="Сумма ставки">Сумма ставки</span>
            <span title="Сумма для ставки" style="color:#ffb86c;font-size:15px;"></span>
          </div>
          <div style="display:flex;gap:8px;align-items:center;justify-content:space-between;background:#23232b;border-radius:16px;padding:8px 8px;margin-bottom:18px;max-width:320px;width:100%;margin-left:auto;margin-right:auto;overflow-x:auto;">
            <button id="betMin" class="bet-btn" style="padding:8px 12px;border-radius:8px;font-weight:700;">min</button>
            <button id="betMinus" class="bet-btn">−</button>
            <input id="betAmountInput" type="number" step="0.1" min="0.1" max="100" value="6" style="font-size:18px;font-weight:700;color:#fff;min-width:60px;max-width:120px;display:inline-block;text-align:center;background:transparent;border:none;outline:none;width:100%;box-sizing:border-box;" />
            <button id="betPlus" class="bet-btn">+</button>
            <button id="betMax" class="bet-btn" style="padding:8px 12px;border-radius:8px;font-weight:700;margin-right:8px;">max</button>
          </div>
        </div>
        <div class="controls" style="display:flex;gap:12px;justify-content:center;">
          <button class="btn-ghost" data-back-to="0" data-i18n="← Назад">← Назад</button>
          <button class="btn-primary" data-next-to="9" data-i18n="Далее →">Далее →</button>
        </div>
        <style>
          .mine-cell.opened {
  background: linear-gradient(180deg,#ffe6c0,#ffd9a8);
  box-shadow: 0 0 0 2px #ffe6c0, 0 2px 10px #ffc98844;
  filter: brightness(1.08);
}
.mine-cell.mine {
  background: linear-gradient(180deg,#ff6a6a,#ffb36d);
  position:relative;
}
.mine-cell.mine::after {
  content: '';
  position: absolute;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  background: url('images/Снимок экрана 2025-10-10 223322.png') center/cover no-repeat;
  pointer-events: none;
}
.mine-cell.fail {
  box-shadow:0 0 0 4px #ff3a3a,0 2px 10px #ff3a3a44;
  filter:brightness(1.05) saturate(1.1);
}
.mine-cell.win {
  position: relative;
}
.mine-cell.win::after {
  content: '';
  position: absolute;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  background: url('images/Снимок экрана 2025-10-10 225132.png') center/cover no-repeat;
  pointer-events: none;
  opacity: 0;
  transition: opacity 0.18s;
  overflow: hidden;
}
.mine-cell.win.reveal::after {
  animation: win-light 0.5s linear forwards;
}
.mine-cell.win::after {
  /* ...остальные стили... */
}

@keyframes win-light {
  0% {
    opacity: 0;
    filter: brightness(1) drop-shadow(0 0 0 #fff);
    mask-image: linear-gradient(90deg, #fff 0%, #fff 0%, transparent 0%);
    -webkit-mask-image: linear-gradient(90deg, #fff 0%, #fff 0%, transparent 0%);
  }
  40% {
    opacity: 1;
    filter: brightness(1.3) drop-shadow(0 0 18px #fff8);
    mask-image: linear-gradient(90deg, #fff 0%, #fff 60%, transparent 100%);
    -webkit-mask-image: linear-gradient(90deg, #fff 0%, #fff 60%, transparent 100%);
  }
  100% {
    opacity: 1;
    filter: brightness(1.7) drop-shadow(0 0 32px #fff8);
    mask-image: linear-gradient(90deg, #fff 0%, #fff 100%, transparent 100%);
    -webkit-mask-image: linear-gradient(90deg, #fff 0%, #fff 100%, transparent 100%);
  }
}
#restartGameBtn.start-btn {
  width:140px;height:56px;font-size:18px;margin:24px auto 0 auto;display:block;
}
          .grid-btn {
            background: #23232b;
            color: #fff;
            border: none;
            border-radius: 10px;
            padding: 10px 18px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: background 0.18s, color 0.18s, box-shadow 0.18s;
          }
          .grid-btn:hover {
            background: #35353e;
            box-shadow: 0 2px 10px rgba(40,40,60,0.12);
          }
          .grid-btn.active {
            background: #44424a;
            color: #ffb86c;
          }
          .min-btn, .bet-btn {
            background: #23232b;
            color: #fff;
            border: none;
            border-radius: 10px;
            padding: 15px 16px;
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            transition: background 0.18s, color 0.18s, box-shadow 0.18s;
          }
          .min-btn:hover, .bet-btn:hover {
            background: #35353e;
            box-shadow: 0 2px 10px rgba(40,40,60,0.12);
          }
          .min-btn:active, .bet-btn:active {
            background: #44424a;
            color: #ffb86c;
          }
        </style>
        <script>
// Показывать предупреждение, если имя не введено при первом заходе
document.addEventListener('DOMContentLoaded', function() {
  var userNameInput = document.getElementById('userNameInput');
  var userNameWarning = document.getElementById('userNameWarning');
  if (userNameInput && userNameWarning) {
    function checkName() {
      if (!userNameInput.value.trim()) {
        userNameWarning.style.display = 'block';
      } else {
        userNameWarning.style.display = 'none';
      }
    }
    userNameInput.addEventListener('input', checkName);
    checkName();
  }
});
// Динамическая высота .card для Turbo Mines (с применением !important)
function setCardMinHeightByGrid() {
  const card = document.querySelector('.card');
  if (card) {
    // Для всех сеток Turbo Mines — одинаковая высота
    card.style.setProperty('min-height', '680px', 'important');
  }
}
document.addEventListener('DOMContentLoaded', function() {
  // Исправление бага: всегда очищать minesGridContainer при смене сетки
  document.querySelectorAll('.grid-btn').forEach(btn => {
    btn.addEventListener('click', function() {
      const grid = btn.dataset.size;
      const minesGridContainer = document.getElementById('minesGridContainer');
      if (minesGridContainer) {
        minesGridContainer.innerHTML = '';
        minesGridContainer.style.display = 'none';
      }
      const turboArea = document.getElementById('turboMines7x7Area');
      if (turboArea && (grid === '3' || grid === '5')) {
        turboArea.innerHTML = '';
        turboArea.style.display = 'none';
      }
    });
  });
  // Мгновенный рендер 9x9 при выборе сетки, если активна step-9
  document.querySelectorAll('.grid-btn').forEach(btn => {
    btn.addEventListener('click', function() {
      const grid = btn.dataset.size;
      const step9 = document.getElementById('step-9');
      if (grid === '9' && step9 && step9.classList.contains('active')) {
        showTurboMinesGame7x7();
      }
    });
  });
  const nextBtn = document.querySelector('[data-next-to="9"]');
  if (nextBtn) {
    nextBtn.addEventListener('click', function() {
      setTimeout(setCardMinHeightByGrid, 120);
    });
  }
  // При загрузке step-9 сразу корректируем высоту
  if (document.getElementById('step-9')?.classList.contains('active')) {
    setCardMinHeightByGrid();
  }
  // Сброс min-height при возврате на другие вкладки
  document.querySelectorAll('[data-back-to]').forEach(btn => {
    btn.addEventListener('click', function() {
      const card = document.querySelector('.card');
      if (card) card.style.removeProperty('min-height');
    });
  });
});
        document.addEventListener('DOMContentLoaded', function() {
          // По умолчанию сетка 3x3 при первом входе
          try {
            localStorage.setItem('vavada_selected_grid', '3');
            document.querySelectorAll('.grid-btn').forEach(btn => {
              btn.classList.remove('active');
              btn.disabled = false;
              if (btn.textContent.trim() === '3x3') {
                btn.classList.add('active');
              }
            });
          } catch(e) {}
          // Сетка
          const gridBtns = document.querySelectorAll('.grid-btn');
          let gridSize = 3;
          gridBtns.forEach(btn => {
            btn.addEventListener('click', function() {
              gridBtns.forEach(b => b.classList.remove('active'));
              btn.classList.add('active');
              gridSize = parseInt(btn.dataset.size, 10);
              try { localStorage.setItem('vavada_selected_grid', String(gridSize)); } catch(e){}
            });
            if (parseInt(btn.dataset.size, 10) === gridSize) btn.classList.add('active');
          });
          // Кол-во мин
          const minCountEl = document.getElementById('minCount');
          const minMinus = document.getElementById('minMinus');
          const minPlus = document.getElementById('minPlus');
          let minCount = null;
          function getMinesMsg() {
            const langRaw = localStorage.getItem('vavada_lang') || 'RUS';
            const lang = langRaw === 'KZT' ? 'KAZ' : langRaw;
            const minesMsgKey = 'Введите мины';
            if (translations[lang] && translations[lang][minesMsgKey]) {
              return translations[lang][minesMsgKey];
            }
            if (lang === 'ENG') return 'Enter mines';
            if (lang === 'KAZ') return 'Миналарды енгізіңіз';
            return minesMsgKey;
          }
          minCountEl.textContent = getMinesMsg();
          window.minCount = null;
          function updateStartBtnState() {
            var startBtn = document.getElementById('startGameBtn');
            if (startBtn) {
              startBtn.disabled = (minCount === null);
              startBtn.style.opacity = (minCount === null) ? '0.5' : '1';
              startBtn.style.pointerEvents = (minCount === null) ? 'none' : 'auto';
            }
          }
          minMinus.addEventListener('click', function() {
            if (minCount === null) minCount = 1;
            else if (minCount > 1) minCount--;
            minCountEl.textContent = minCount;
            window.minCount = minCount;
            updateStartBtnState();
          });
          minPlus.addEventListener('click', function() {
            if (minCount === null) minCount = 1;
            else if (minCount < gridSize * gridSize - 1) minCount++;
            minCountEl.textContent = minCount;
            window.minCount = minCount;
            updateStartBtnState();
          });
          updateStartBtnState();
          // Сумма ставки
          const betAmountInput = document.getElementById('betAmountInput');
          const betMin = document.getElementById('betMin');
          const betMax = document.getElementById('betMax');
          const betMinus = document.getElementById('betMinus');
          const betPlus = document.getElementById('betPlus');
          let betAmount = 6;
          const currencySymbol = document.createElement('span');
          currencySymbol.id = 'currencySymbol';
          currencySymbol.style = 'font-size:22px;color:#ffb86c;margin-left:8px;min-width:32px;display:inline-block;text-align:left;';
          betAmountInput.parentNode.insertBefore(currencySymbol, betPlus);
          function getCurrency() {
            return localStorage.getItem('vavada_currency') || 'USD';
          }
          function updateCurrencyLimits() {
            const currency = getCurrency();
            const limits = {
              RUB: { min: 10, max: 10000, symbol: '₽' },
              EUR: { min: 0.1, max: 105, symbol: '€' },
              KZT: { min: 66, max: 66000, symbol: '₸' },
              USD: { min: 0.1, max: 120, symbol: '$' }
            };
            const lim = limits[currency] || limits['USD'];
            betAmountInput.min = lim.min;
            betAmountInput.max = lim.max;
            currencySymbol.textContent = lim.symbol;
            if (betAmount < lim.min) betAmount = lim.min;
            if (betAmount > lim.max) betAmount = lim.max;
            updateBetInput();
          }
          function updateBetInput() {
            betAmountInput.value = betAmount;
          }
          betMin.addEventListener('click', function() { betAmount = parseFloat(betAmountInput.min); updateBetInput(); });
          betMax.addEventListener('click', function() { betAmount = parseFloat(betAmountInput.max); updateBetInput(); });
          betMinus.addEventListener('click', function() { if (betAmount > parseFloat(betAmountInput.min)) { betAmount = Math.max(parseFloat(betAmountInput.min), +(betAmount - 0.1).toFixed(2)); updateBetInput(); } });
          betPlus.addEventListener('click', function() { if (betAmount < parseFloat(betAmountInput.max)) { betAmount = Math.min(parseFloat(betAmountInput.max), +(betAmount + 0.1).toFixed(2)); updateBetInput(); } });
          betAmountInput.addEventListener('input', function() {
            let val = betAmountInput.value.replace(',', '.');
            if (val === "") return;
            val = parseFloat(val);
            if (isNaN(val)) val = parseFloat(betAmountInput.min);
            if (val < parseFloat(betAmountInput.min)) val = parseFloat(betAmountInput.min);
            if (val > parseFloat(betAmountInput.max)) val = parseFloat(betAmountInput.max);
            betAmount = +(val).toFixed(2);
            updateBetInput();
          });
          document.querySelectorAll('.currency-btn').forEach(btn => {
            btn.addEventListener('click', function() {
              localStorage.setItem('vavada_currency', btn.dataset.currency);
              updateCurrencyLimits();
            });
          });
          updateCurrencyLimits();
        });
        // Установить сетку 3x3 по умолчанию при загрузке страницы
try {
  if (!localStorage.getItem('vavada_selected_grid')) {
    localStorage.setItem('vavada_selected_grid', '3');
  }
} catch(e) {}
        </script>
      </section>

      <!-- STEP 9: Turbo Mines — вкладка 2 (пустая) -->
      <section class="step" id="step-9" style="height: 900px;">
<div id="turboMines7x7Area" style="width:100%;display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:80px;"></div>
<style>
.mines-grid.cols-7 {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  gap: 12px;
  width: 650px;
  margin: 0 auto;
  background: transparent;
}
.mines-grid.cols-7 .mine-cell {
  background: #23262b;
  border-radius: 18px;
  aspect-ratio: 1 / 1;
  width: 100%;
  box-shadow: 0 0 0 1px #ff9800, 0 2px 6px #ff980044, inset 0 1px 4px rgba(0,0,0,0.5);
  border: 1px solid #ff9800;
  position: relative;
  overflow: hidden;
  transition: box-shadow 0.18s, filter 0.18s, background 0.18s, border-color 0.18s;
  cursor: pointer;
}
.mines-grid.cols-7 .mine-cell:hover, .mines-grid.cols-7 .mine-cell:active {
  border-color: #ffb347;
  box-shadow: 0 0 0 4px #ffb347;
  z-index: 2;
}
.mine-cell.opened {
  background: linear-gradient(180deg,#ffe6c0,#ffd9a8);
  box-shadow: 0 0 0 2px #ffe6c0, 0 2px 10px #ffc98844;
  filter: brightness(1.08);
}
.mine-cell.mine {
  background: linear-gradient(180deg,#ff6a6a,#ffb36d);
}
.mine-cell.mine::after {
  content: '';
  position: absolute;
  left: 0; top: 0; width: 100%; height: 100%;
  background: url('images/Снимок экрана 2025-10-10 223322.png') center/cover no-repeat;
  pointer-events: none;
}
.mine-cell.fail {
  box-shadow:0 0 0 4px #ff3a3a,0 2px 10px #ff3a3a44;
  filter:brightness(1.05) saturate(1.1);
}
.mine-cell.win {
  position: relative;
}
.mine-cell.win::after {
  content: '';
  position: absolute;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  background: url('images/Снимок экрана 2025-10-10 225132.png') center/cover no-repeat;
  pointer-events: none;
  opacity: 0;
  transition: opacity 0.18s;
}
.mine-cell.win.reveal::after {
  opacity: 1;
}
#restartGameBtn7x7.start-btn {
  width:96px;
  height:96px;
  border-radius:50%;
  font-size:16px;
  margin:18px auto 0 auto;
  display:flex;
  align-items:center;
  justify-content:center;
}
</style>
<script>
// Turbo Mines 7x7: только для режима 7x7, остальные не трогаем
// Turbo Mines 9x9: аналогичная логика
function renderTurboMinesGrid9x9(mineCount, gameActive = false, mineIndexes = []) {
  const area = document.getElementById('turboMines7x7Area');
  area.innerHTML = '';
  const size = 9;
  const grid = document.createElement('div');
  grid.className = 'mines-grid cols-9';
  const cells = [];
  for (let i = 0; i < size * size; i++) {
    const cell = document.createElement('div');
    cell.className = 'mine-cell';
    cell.dataset.index = i;
    cell.addEventListener('click', function() {
      if (!gameActive) return;
      if (cell.classList.contains('opened')) return;
      if (mineIndexes.includes(i)) {
        cell.classList.add('mine', 'fail', 'opened');
        setTimeout(() => {
          cells.forEach((c, idx) => {
            if (mineIndexes.includes(idx)) {
              if (!c.classList.contains('opened')) {
                c.classList.add('mine', 'fail', 'opened');
              }
            } else {
              if (!c.classList.contains('opened')) {
                c.classList.add('opened', 'win', 'reveal');
              }
            }
          });
        }, 400);
      } else {
        cell.classList.add('opened', 'win', 'reveal');
      }
    });
    cells.push(cell);
    grid.appendChild(cell);
  }
  area.appendChild(grid);
  if (!gameActive) {
    const startBtn = document.createElement('button');
    startBtn.id = 'restartGameBtn9x9';
    startBtn.className = 'start-btn';
    startBtn.textContent = getStartBtnText();
    if (!mineCount || typeof mineCount !== 'number') {
      startBtn.disabled = true;
      startBtn.style.opacity = '0.5';
      startBtn.style.pointerEvents = 'none';
    }
    startBtn.onclick = function() {
      if (!mineCount || typeof mineCount !== 'number') return;
      let minesArr = [];
      while (minesArr.length < mineCount) {
        let idx = Math.floor(Math.random() * (size * size));
        if (!minesArr.includes(idx)) minesArr.push(idx);
      }
      renderTurboMinesGrid9x9(mineCount, true, minesArr);
    };
    area.appendChild(startBtn);
  } else {
    const cancelBtn = document.createElement('button');
    cancelBtn.id = 'cancelGameBtn9x9';
    cancelBtn.className = 'start-btn cancel-btn';
    cancelBtn.textContent = getCancelBtnText();
    cancelBtn.onclick = function() {
      renderTurboMinesGrid9x9(mineCount, false, []);
    };
    area.appendChild(cancelBtn);
  }
}
document.addEventListener('DOMContentLoaded', function() {
  // Turbo Mines 7x7: логика как у 5x5 — старт по кнопке, отмена, блокировка до старта
  function renderTurboMinesGrid7x7(mineCount, gameActive = false, mineIndexes = []) {
  // Turbo Mines 9x9: аналогичная логика
  function renderTurboMinesGrid9x9(mineCount, gameActive = false, mineIndexes = []) {
    const area = document.getElementById('turboMines7x7Area');
    area.innerHTML = '';
    const size = 9;
    const grid = document.createElement('div');
    grid.className = 'mines-grid cols-9';
    const cells = [];
    for (let i = 0; i < size * size; i++) {
      const cell = document.createElement('div');
      cell.className = 'mine-cell';
      cell.dataset.index = i;
      cell.addEventListener('click', function() {
        if (!gameActive) return;
        if (cell.classList.contains('opened')) return;
        if (mineIndexes.includes(i)) {
          cell.classList.add('mine', 'fail', 'opened');
          setTimeout(() => {
            cells.forEach((c, idx) => {
              if (mineIndexes.includes(idx)) {
                if (!c.classList.contains('opened')) {
                  c.classList.add('mine', 'fail', 'opened');
                }
              } else {
                if (!c.classList.contains('opened')) {
                  c.classList.add('opened', 'win', 'reveal');
                }
              }
            });
          }, 400);
        } else {
          cell.classList.add('opened', 'win', 'reveal');
        }
      });
      cells.push(cell);
      grid.appendChild(cell);
    }
    area.appendChild(grid);
    if (!gameActive) {
      const startBtn = document.createElement('button');
      startBtn.id = 'restartGameBtn9x9';
      startBtn.className = 'start-btn';
      startBtn.textContent = getStartBtnText();
      if (!mineCount || typeof mineCount !== 'number') {
        startBtn.disabled = true;
        startBtn.style.opacity = '0.5';
        startBtn.style.pointerEvents = 'none';
      }
      startBtn.onclick = function() {
        if (!mineCount || typeof mineCount !== 'number') return;
        let minesArr = [];
        while (minesArr.length < mineCount) {
          let idx = Math.floor(Math.random() * (size * size));
          if (!minesArr.includes(idx)) minesArr.push(idx);
        }
        renderTurboMinesGrid9x9(mineCount, true, minesArr);
      };
      area.appendChild(startBtn);
    } else {
      const cancelBtn = document.createElement('button');
      cancelBtn.id = 'cancelGameBtn9x9';
      cancelBtn.className = 'start-btn cancel-btn';
      cancelBtn.textContent = getCancelBtnText();
      cancelBtn.onclick = function() {
        renderTurboMinesGrid9x9(mineCount, false, []);
      };
      area.appendChild(cancelBtn);
    }
  }
    const area = document.getElementById('turboMines7x7Area');
    area.innerHTML = '';
    const size = 7;
    const grid = document.createElement('div');
    grid.className = 'mines-grid cols-7';
    // Генерация клеток
    const cells = [];
    for (let i = 0; i < size * size; i++) {
      const cell = document.createElement('div');
      cell.className = 'mine-cell';
      cell.dataset.index = i;
      // Клик по клетке только если игра активна
      cell.addEventListener('click', function() {
        if (!gameActive) return;
        if (cell.classList.contains('opened')) return;
        if (mineIndexes.includes(i)) {
          cell.classList.add('mine', 'fail', 'opened');
          // Вскрываем все остальные клетки
          setTimeout(() => {
            cells.forEach((c, idx) => {
              if (mineIndexes.includes(idx)) {
                if (!c.classList.contains('opened')) {
                  c.classList.add('mine', 'fail', 'opened');
                }
              } else {
                if (!c.classList.contains('opened')) {
                  c.classList.add('opened', 'win', 'reveal');
                }
              }
            });
          }, 400);
        } else {
          cell.classList.add('opened', 'win', 'reveal');
        }
      });
      cells.push(cell);
      grid.appendChild(cell);
    }
    area.appendChild(grid);
    if (!gameActive) {
      // Кнопка СТАРТ
      const startBtn = document.createElement('button');
      startBtn.id = 'restartGameBtn7x7';
      startBtn.className = 'start-btn';
      startBtn.textContent = getStartBtnText();
      // Если мины не выбраны, блокируем кнопку
      if (!mineCount || typeof mineCount !== 'number') {
        startBtn.disabled = true;
        startBtn.style.opacity = '0.5';
        startBtn.style.pointerEvents = 'none';
      }
      startBtn.onclick = function() {
        if (!mineCount || typeof mineCount !== 'number') return;
        // Генерируем мины и запускаем игру
        let minesArr = [];
        while (minesArr.length < mineCount) {
          let idx = Math.floor(Math.random() * (size * size));
          if (!minesArr.includes(idx)) minesArr.push(idx);
        }
        renderTurboMinesGrid7x7(mineCount, true, minesArr);
      };
      area.appendChild(startBtn);
    } else {
      // Кнопка ОТМЕНИТЬ
      const cancelBtn = document.createElement('button');
      cancelBtn.id = 'cancelGameBtn7x7';
      cancelBtn.className = 'start-btn cancel-btn';
      cancelBtn.textContent = getCancelBtnText();
      cancelBtn.onclick = function() {
        // Сброс игры
        renderTurboMinesGrid7x7(mineCount, false, []);
      };
      area.appendChild(cancelBtn);
    }
  }
  // Получаем выбранную сетку и мину
  function getSelectedMineCount7x7() {
    let grid = localStorage.getItem('vavada_selected_grid');
    let mineCount = window.minCount;
    if (grid !== '7') return null;
    return mineCount;
  }
  // Показываем игровую область всегда, но блокируем старт если мины не выбраны
  function showTurboMinesGame7x7() {
    let grid = localStorage.getItem('vavada_selected_grid');
    let mineCount = window.minCount;
    const turboArea = document.getElementById('turboMines7x7Area');
    if (grid === '7') {
      if (turboArea) turboArea.style.display = 'flex';
      renderTurboMinesGrid7x7(mineCount, false, []);
    } else if (grid === '9') {
      if (turboArea) turboArea.style.display = 'flex';
      renderTurboMinesGrid9x9(mineCount, false, []);
    } else {
      if (turboArea) {
        turboArea.innerHTML = '';
        turboArea.style.display = 'none';
      }
    }
  }
  // Слушаем переход на вкладку Turbo Mines (step-9)
  document.querySelector('[data-next-to="9"]').addEventListener('click', function() {
    setTimeout(() => {
      const grid = localStorage.getItem('vavada_selected_grid');
      if (grid === '9') {
        showTurboMinesGame7x7();
      } else if (grid === '7') {
        showTurboMinesGame7x7();
      }
    }, 120);
  });
  // Если уже на step-9 и выбрана 7x7 или 9x9, показываем
  if (document.getElementById('step-9').classList.contains('active')) {
    const grid = localStorage.getItem('vavada_selected_grid');
    if (grid === '7' || grid === '9') {
      showTurboMinesGame7x7();
    }
  }
  // Следим за изменением количества мин и обновляем область
  document.getElementById('minMinus').addEventListener('click', function() {
    let grid = localStorage.getItem('vavada_selected_grid');
    if ((grid === '7' || grid === '9') && document.getElementById('step-9').classList.contains('active')) {
      showTurboMinesGame7x7();
    }
  });
  document.getElementById('minPlus').addEventListener('click', function() {
    let grid = localStorage.getItem('vavada_selected_grid');
    if ((grid === '7' || grid === '9') && document.getElementById('step-9').classList.contains('active')) {
      showTurboMinesGame7x7();
    }
  });
});
</script>
        <div style="max-width:420px;margin:0 auto;padding:20px 0 0 0;">
          <div id="minesGridWrapper" style="margin-bottom:18px;  ">
            <div id="minesGridContainer" class="mines-grid" style="display:none;"></div>
            <button id="startGameBtn" class="start-btn" style="display:none; margin-right: 112px;" data-i18n="СТАРТ">СТАРТ</button>
          </div>
        </div>
        <div class="controls" style="display:flex;gap:12px;justify-content:center;">
          <button class="btn-ghost" data-back-to="0" data-i18n="← Назад">← Назад</button>
          <button class="btn-primary" data-next-to="9" data-i18n="next" style="display:none">Далее →</button>
        </div>
        <style>
          /* Обёртка сетки — фон и лёгкая рамка как на фото */
          #minesGridWrapper{
           
          }
          .mines-grid{
            display:grid;
            gap:8px; /* уменьшенный отступ — клетки ближе друг к другу */
            width:520px; /* ширина, чтобы каждая клетка была больше */
            margin:0 auto;
            padding:4px;
            box-sizing:border-box;
            background:transparent;
            grid-auto-rows: 1fr; /* чтобы ряды были равны */
          }
          .mines-grid.cols-3{grid-template-columns:repeat(3,1fr)}
          .mines-grid.cols-5{grid-template-columns:repeat(5,1fr)}
          .mines-grid.cols-7{grid-template-columns:repeat(7,1fr)}
          .mines-grid.cols-9{grid-template-columns:repeat(9,1fr)}
.mines-grid.cols-9 {
  gap: 8px !important;
  width: 720px !important;
}
.mines-grid.cols-9 .mine-cell {
  border-radius: 14px !important;
  min-width: 65px;
  min-height: 65px;
  width: 100%;
  height: 100%;
  font-size: 19px;
}
          /* Клетки — тёмный центр, скругления, тонкая оранжевая рамка внутри */
          .mine-cell{
            background: linear-gradient(135deg, #23262b 80%, #181a1f 100%);
            border-radius: 20px;
            aspect-ratio: 1 / 1;
            width: 100%;
            box-shadow: 0 0 0 2px #ce8908, 0 2px 10px #ff980044, inset 0 2px 8px rgba(0,0,0,0.7);
            border: 2px solid #ff9800;
            position: relative;
            overflow: hidden;
            transition: box-shadow 0.18s, filter 0.18s, background 0.18s, border-color 0.18s;
            cursor: pointer;
          }
          .mine-cell:hover, .mine-cell:active {
            border-color: #ffb347;
            box-shadow: 0 0 0 4px #ffb347;
            z-index: 2;
          }
          /* Тонкая градиентная рамка по внутреннему краю, как на фото */
          .mine-cell::after{
            content:'';
            position:absolute;
            inset:6px;
            border-radius:14px;
            padding:1px;
            pointer-events:none;
            background: linear-gradient(90deg, rgba(19, 4, 4, 0.473), rgba(15, 13, 12, 0.459));
            -webkit-mask: linear-gradient(#fff 0 0);
            mask: linear-gradient(#fff 0 0);
            mix-blend-mode:screen;
            opacity:0.98;
          }
          /* Внутренняя заливка чтобы рамка была тонкой (псевдоэлемент закрывает центр) */
          .mine-cell::before{
            content:'';position:absolute;inset:8px;border-radius:12px;background:linear-gradient(180deg, rgba(24,26,28,0.98), rgba(28,30,32,0.98));pointer-events:none;box-shadow:inset 0 1px 0 rgba(255,255,255,0.02);
          }
          .start-btn{display:block;margin:18px auto 0 auto;width:96px;height:96px;border-radius:50%;border:2px solid rgba(255,180,110,0.95);background:linear-gradient(180deg,#ffc988,#ff8a3d);color:#021225;font-weight:800;cursor:pointer;font-size:16px;box-shadow:0 14px 34px rgba(255,120,60,0.14);align-items:center;justify-content:center;display:flex;transition:box-shadow 0.18s, filter 0.18s, background 0.18s;}
          .start-btn:hover, .start-btn:active {
            filter: brightness(1.13) saturate(1.08);
            box-shadow: 0 0 0 4px #ffc988, 0 18px 44px 0 rgba(255,180,110,0.18), 0 14px 34px rgba(255,120,60,0.14);
            background: linear-gradient(180deg,#ffd9a8,#ffb36d);
          }
        </style>
        <script>
        (function(){
          var minesGridContainer = document.getElementById('minesGridContainer');
          var startGameBtn = document.getElementById('startGameBtn');
          let mines = [];
          let opened = [];
          let gameActive = false;
          function renderGrid(){
            if(!minesGridContainer) return;
            var grid = localStorage.getItem('vavada_selected_grid');
            var step9 = document.getElementById('step-9');
            if(!step9.classList.contains('active')){
              minesGridContainer.innerHTML = '';
              minesGridContainer.style.display='none';
              startGameBtn.style.display='none';
              return;
            }
            if(grid==='5'){
              minesGridContainer.innerHTML='';
              minesGridContainer.className='mines-grid cols-5';
              minesGridContainer.style.gridTemplateColumns = 'repeat(5, 1fr)';
              for(var i=0;i<25;i++){
                var d=document.createElement('div');
                d.className='mine-cell';
                d.dataset.idx = i;
                d.addEventListener('click', function(){
                  if(!gameActive) return;
                  var idx = parseInt(this.dataset.idx);
                  if(opened.includes(idx)) return;
                  opened.push(idx);
                  if(mines.includes(idx)){
                    this.classList.add('mine','fail','opened');
                    endGame(false);
                  }else{
                    this.classList.add('opened','win','reveal');
                    if(opened.length === (25 - mines.length)) endGame(true);
                  }
                });
                minesGridContainer.appendChild(d);
              }
              minesGridContainer.style.display='grid';
              startGameBtn.style.display='flex';
            } else if(grid==='3'){
              minesGridContainer.innerHTML='';
              minesGridContainer.className='mines-grid cols-3';
              minesGridContainer.style.gridTemplateColumns = 'repeat(3, 1fr)';
              for(var i=0;i<9;i++){
                var d=document.createElement('div');
                d.className='mine-cell';
                d.dataset.idx = i;
                d.addEventListener('click', function(){
                  if(!gameActive) return;
                  var idx = parseInt(this.dataset.idx);
                  if(opened.includes(idx)) return;
                  opened.push(idx);
                  if(mines.includes(idx)){
                    this.classList.add('mine','fail','opened');
                    endGame(false);
                  }else{
                    this.classList.add('opened','win','reveal');
                    if(opened.length === (9 - mines.length)) endGame(true);
                  }
                });
                minesGridContainer.appendChild(d);
              }
              minesGridContainer.style.display='grid';
              startGameBtn.style.display='flex';
            } else {
              minesGridContainer.innerHTML = '';
              minesGridContainer.style.display='none';
              startGameBtn.style.display='none';
            }
            mines = [];
            opened = [];
            gameActive = false;
            let btn = document.getElementById('restartGameBtn');
            if(btn) btn.remove();
          }
          function startGame(){
            var grid = localStorage.getItem('vavada_selected_grid');
            let minCount = window.minCount;
            let total = grid==='5' ? 25 : 9;
            if (typeof minCount !== 'number' || isNaN(minCount)) minCount = grid==='5' ? 1 : 3;
            if (minCount < 1) minCount = 1;
            if (grid==='5' && minCount > 24) minCount = 24;
            if (grid==='3' && minCount > 8) minCount = 8;
            mines = [];
            opened = [];
            gameActive = true;
            let arr = Array.from({length:total},(_,i)=>i);
            while(mines.length < minCount){
              let idx = Math.floor(Math.random()*arr.length);
              mines.push(arr[idx]);
              arr.splice(idx,1);
            }
            document.querySelectorAll('.mine-cell').forEach(cell=>{
              cell.classList.remove('mine','fail','opened','win','reveal');
            });
            let btn = document.getElementById('restartGameBtn');
            if(btn) btn.remove();
            if(startGameBtn){
              startGameBtn.style.display = 'none';
              let cancelBtn = document.createElement('button');
              cancelBtn.id = 'restartGameBtn';
              cancelBtn.className = 'start-btn cancel-btn';
              cancelBtn.style.marginLeft = '185px';
              cancelBtn.textContent = getCancelBtnText();
              cancelBtn.addEventListener('click', function(){
                gameActive = false;
                opened = [];
                mines = [];
                document.querySelectorAll('.mine-cell').forEach(cell=>{
                  cell.classList.remove('mine','fail','opened','win','reveal');
                });
                cancelBtn.remove();
                if(startGameBtn) startGameBtn.style.display = 'flex';
              });
              startGameBtn.parentNode.appendChild(cancelBtn);
            }
          }
          function endGame(win){
            gameActive = false;
            document.querySelectorAll('.mine-cell').forEach((cell,i)=>{
              if(mines.includes(i)) cell.classList.add('mine','fail','opened');
              else cell.classList.add('win','reveal');
            });
          }
          if(startGameBtn){
            startGameBtn.addEventListener('click', function(){
              startGame();
            });
          }
          function readAndRender(){
            renderGrid();
          }
          window.addEventListener('storage', function(e){ if(e.key==='vavada_selected_grid') readAndRender(); });
          setTimeout(readAndRender,300);

  // Исправление: обработчик для кнопки 'Далее' на step-8
  var nextBtn = document.querySelector('.btn-primary[data-next-to="9"]');
  if(nextBtn){
    nextBtn.addEventListener('click', function(){
      document.querySelectorAll('.step').forEach(function(s){s.classList.remove('active');});
      var step9 = document.getElementById('step-9');
      if(step9){
        step9.classList.add('active');
        renderGrid();
      }
    });
  }
})();
</script>
      </section>

      <!-- STEP 9: Turbo Mines — вкладка 2 (пустая) -->
      <section class="step" id="step-9">
        <div style="padding:40px 0;text-align:center;color:var(--muted);font-size:18px;">Turbo Mines — вкладка 2 (пустая)</div>
        <div class="controls" style="display:flex;gap:12px;justify-content:center;">
          <button class="btn-ghost" data-back-to="← Назад">← Назад</button>
        </div>
      </section>
          
        </div>
      </div>

      <!-- STEP 0: Главная -->
      <section class="step active" id="step-0">
        <div>
          <label data-i18n="Имя пользователя VAVADA">Имя пользователя VAVADA</label>
            <input id="username" type="text" placeholder="Введите имя пользователя VAVADA" data-i18n-placeholder="Введите имя пользователя VAVADA">
            <div id="nameWarning" style="color:#ff3a3a;font-size:13px;margin-top:4px;display:none;" data-i18n="Введите никнейм чтобы продолжить!">Введите никнейм чтобы продолжить!</div>
            <div id="nameHint" style="color:#e53935;font-size:13px;margin-top:4px;display:none;" data-i18n="Введите имя, чтобы продолжить">Введите имя, чтобы продолжить</div>
          <div id="nameCheckInline" style="display:none;margin-top:8px;align-items:center;gap:10px;min-height:24px;">
            <span id="nameCheckSpinner" class="loader-inline" style="display:inline-block;width:22px;height:22px;border:3px solid #2dd4bf;border-top:3px solid #0066ff;border-radius:50%;vertical-align:middle;animation:spin 1s linear infinite;"></span>
            <span id="nameCheckText" style="color:#1976d2;font-size:15px;vertical-align:middle;" data-i18n="Проверка имени на VAVADA…">Проверка имени на VAVADA…</span>
          </div>
        </div>
        <div>
          <label data-i18n="Выбор игр">Выбор игр</label>
          <select id="gameSelect" data-i18n="Выбор игр">
            <option value="chicken" data-i18n="Chicken Road 2">Chicken Road 2</option>
            <option value="aviator" data-i18n="Aviator">Aviator</option>
            <!-- Penalty удалён -->
            <option value="turbo" data-i18n="Turbo Mines">Turbo Mines</option>
          </select>
        </div>

        <div style="display:flex;gap:12px;align-items:center;margin-top:6px">
          <button class="btn-primary" id="toNextFrom0" disabled data-i18n="Далее →">Далее →</button>
<script>
// Блокировка кнопки "Далее" и анимация проверки имени (инлайн) + валидация
document.addEventListener('DOMContentLoaded', function() {
  var usernameInput = document.getElementById('username');
  var nextBtn = document.getElementById('toNextFrom0');
  var nameHint = document.getElementById('nameHint');
  var nameWarning = document.getElementById('nameWarning');
  var nameCheckInline = document.getElementById('nameCheckInline');
  var nameChecked = false;

  // Список запрещённых слов (можно расширить)
  var badWords = [
    'fuck','shit','bitch','сука','хуй','пизд','еба','гандон','fag','asshole','idiot','moron','retard','cunt','faggot','dick','cock','nigger','nigga','fool','дурак','лох','мудак','урод','гавно','гнида','мразь','kill','admin','support','vavada','casino','казино','админ','поддержка'
  ];

  // Проверка: если имя уже сохранено, сразу разблокировать кнопку и скрыть подсказки
  var savedName = localStorage.getItem('vavada_username');
  if (savedName && savedName.trim().length > 0) {
    usernameInput.value = savedName;
    nextBtn.disabled = false;
    nameChecked = true; 
    if (nameHint) nameHint.style.display = 'none';
    if (nameWarning) nameWarning.style.display = 'none';
    if (nameCheckInline) nameCheckInline.style.display = 'none';
    // поле всегда доступно для редактирования
  } else {
    if (nameWarning) nameWarning.style.display = '';
  }

  function setLoadingInline(state) {
    if (nameCheckInline) nameCheckInline.style.display = state ? 'flex' : 'none';
    if (nextBtn) nextBtn.disabled = state;
    if (state) {
      var spinner = document.getElementById('nameCheckSpinner');
      var text = document.getElementById('nameCheckText');
      if (spinner) spinner.style.display = 'inline-block';
      if (text) {
        var langRaw = localStorage.getItem('vavada_lang') || 'RUS';
        var lang = langRaw === 'KZT' ? 'KAZ' : langRaw;
        var msg = {
          RUS: 'Проверка имени на VAVADA…',
          ENG: 'Checking name on VAVADA…',
          KAZ: 'VAVADA-да есімді тексеру…'
        };
        text.textContent = msg[lang] || msg.RUS;
        text.style.color = '#1976d2';
      }
    }
  }

  function isValidName(name) {
    // Только английские буквы, цифры и пробелы, но не только цифры
    // Максимум 30 символов
    var allowed = /^[a-zA-Z0-9 ]{3,30}$/;
    if (!allowed.test(name)) return false;
    // Без подряд пробелов
    if (/  +/.test(name)) return false;
    // Должна быть хотя бы одна английская буква
    if (!/[a-zA-Z]/.test(name)) return false;
    // Без запрещённых слов (регистр не важен)
    var lower = name.toLowerCase();
    for (var i = 0; i < badWords.length; i++) {
      if (lower.includes(badWords[i])) return false;
    }
    return true;
  }

  function getNameLengthMessage(type) {
    var langRaw = localStorage.getItem('vavada_lang') || 'RUS';
    var lang = langRaw === 'KZT' ? 'KAZ' : langRaw;
    var messages = {
      short: {
        RUS: 'Имя слишком короткое (минимум 3 символа)',
        ENG: 'Name is too short (minimum 3 characters)',
        KAZ: 'Есім тым қысқа (ең аз 3 таңба)'
      },
      long: {
        RUS: 'Имя слишком длинное (максимум 30 символов)',
        ENG: 'Name is too long (maximum 30 characters)',
        KAZ: 'Есім тым ұзын (ең көп 30 таңба)'
      }
    };
    if (type === 'short') return messages.short[lang] || messages.short.RUS;
    if (type === 'long') return messages.long[lang] || messages.long.RUS;
    return '';
  }

  function checkName() {
    var val = usernameInput.value.trim();
    if (val.length === 0) {
      nextBtn.disabled = true;
      nameChecked = false;
      if (nameWarning) nameWarning.style.display = '';
      if (nameHint) nameHint.style.display = 'none';
      if (nameCheckInline) nameCheckInline.style.display = 'none';
      return;
    } else {
      if (nameWarning) nameWarning.style.display = 'none';
    }
    if (val.length < 3) {
      nextBtn.disabled = true;
      nameChecked = false;
      if (nameHint) { nameHint.textContent = getNameLengthMessage('short'); nameHint.style.display = ''; }
      if (nameCheckInline) nameCheckInline.style.display = 'none';
      return;
    }
    if (val.length > 30) {
      nextBtn.disabled = true;
      nameChecked = false;
      if (nameHint) { nameHint.textContent = getNameLengthMessage('long'); nameHint.style.display = ''; }
      if (nameCheckInline) nameCheckInline.style.display = 'none';
      return;
    }
    if (!isValidName(val)) {
      nextBtn.disabled = true;
      nameChecked = false;
      if (nameHint) {
        var langRaw = localStorage.getItem('vavada_lang') || 'RUS';
        var lang = langRaw === 'KZT' ? 'KAZ' : langRaw;
        var msg = {
          RUS: 'Имя должно содержать только английские буквы, может содержать цифры и пробелы, без спецсимволов и оскорблений',
          ENG: 'Name must contain only English letters, may contain numbers and spaces, no special characters or insults',
          KAZ: 'Есімде тек ағылшын әріптері, сандар мен бос орындар болуы мүмкін, арнайы таңбалар мен балағат сөздерсіз'
        };
        nameHint.textContent = msg[lang] || msg.RUS;
        nameHint.style.display = '';
      }
      if (nameCheckInline) nameCheckInline.style.display = 'none';
      return;
    }
    // Всё ок — показываем проверку
    setLoadingInline(true);
    if (nameHint) nameHint.style.display = 'none';
    setTimeout(function() {
      var spinner = document.getElementById('nameCheckSpinner');
      var text = document.getElementById('nameCheckText');
      if (spinner) spinner.style.display = 'none';
      if (text) {
        var langRaw = localStorage.getItem('vavada_lang') || 'RUS';
        var lang = langRaw === 'KZT' ? 'KAZ' : langRaw;
        var msg = {
          RUS: 'Пользователь найден!',
          ENG: 'User found!',
          KAZ: 'Пайдаланушы табылды!'
        };
        text.textContent = msg[lang] || msg.RUS;
        text.style.color = '#16a34a';
      }
      setTimeout(function() {
        setLoadingInline(false);
        nameChecked = true;
        nextBtn.disabled = false;
        localStorage.setItem('vavada_username', val);
      }, 2000);
    }, 1500);
  }

  if (usernameInput && nextBtn) {
    nextBtn.disabled = usernameInput.value.trim().length === 0;
    nameChecked = false;
    usernameInput.addEventListener('keydown', function(e) {
      if (e.key === 'Enter') {
        nameChecked = false;
        checkName();
      }
    });
    usernameInput.addEventListener('blur', function() {
      if (!nameChecked) checkName();
    });
    usernameInput.addEventListener('input', function() {
      nameChecked = false;
      checkName();
    });
    // Если поле стало пустым — показать красное предупреждение
    usernameInput.addEventListener('input', function() {
      if (usernameInput.value.trim().length === 0) {
        if (nameWarning) nameWarning.style.display = '';
      } else {
        if (nameWarning) nameWarning.style.display = 'none';
      }
    });
  }
  if (nextBtn) {
  nextBtn.addEventListener('click', function(e) {
    if (usernameInput.value.trim().length === 0) {
      e.preventDefault();
      if (nameHint) {
        nameHint.textContent = 'Введите имя, чтобы продолжить';
        nameHint.style.display = '';
      }
    }
  });
}
});
</script>
          <button class="btn-ghost" id="resetAll" style="display:none;" data-i18n="Сбросить">Сбросить</button>
        </div>
      </section>

      <!-- STEP 1: Баланс и выбор суммы (только для Chicken) -->
      <section class="step" id="step-1">
        <div>
           
          <div class="widget">
            <div style="display:flex;justify-content:space-between;align-items:center">
              <div>
                <div style="color:var(--muted);font-size:13px" data-i18n="Текущий баланс">Текущий баланс</div>
                <div class="balance-amount" id="balanceDisplay">$0.00</div>
              </div>
            
            </div>
          </div>
        </div>

        <div>
          <label data-i18n="Выберите сумму">Выберите сумму</label>
          <div style="display:flex;gap:12px;align-items:center">
            <input id="amountNumber" class="amount-input" type="number" min="0.01" max="200" step="0.01" value="1.00" style="width:150px">
            <input id="amountRange" type="range" min="0.01" max="200" step="0.01" value="1" style="flex:1">
            <div style="margin-left:auto"><button class="btn-primary" id="saveBtn" data-i18n="СОХРАНИТЬ">СОХРАНИТЬ</button></div>
          </div>
        </div>

        <div class="controls">
          <button class="btn-ghost" data-back-to="0" data-i18n="← Назад">← Назад</button>
          <button class="btn-primary" data-next-to="2" data-i18n="Далее →">Далее →</button>
        </div>
      </section>

      <!-- STEP 2: Chicken — генератор (только для Chicken) -->
      <section class="step" id="step-2">
        <div style="display:flex;gap:16px;align-items:center">
          <div class="die" id="dieFace">—</div>
          <div style="flex:1">
            <label data-i18n="chicken_road">Chicken Road 2</label>
            <div style="display:flex;gap:10px;margin-top:8px">
              <button class="btn-primary" id="genBtn" data-i18n="ПОЛУЧИТЬ СТУПЕНЬ">ПОЛУЧИТЬ СТУПЕНЬ</button>
              <button class="btn-ghost" id="clearHistory" data-i18n="Очистить историю">Очистить историю</button>
            </div>
            <div class="history" id="history"></div>
          </div>
        </div>

        <div class="controls">
          <button class="btn-ghost" data-back-to="1" data-i18n="← Назад">← Назад</button>
          <button class="btn-primary" data-back-to="0" data-i18n="На главную">На главную</button>
        </div>
      </section>

      <!-- STEP 3: Aviator — вкладка 1 (выбор режима) -->
      <section class="step" id="step-3">
        <div>
          <label data-i18n="aviator">Aviator</label>
          <div style="color:var(--muted);font-size:13px;margin-top:10px">
            <div class="aviator-bet-widget">
              <div class="abw-toggle">
                <button class="abw-tab active" data-mode="bet" data-i18n="Ставка">Ставка</button>
              </div>
              <div style="display:flex;gap:10px;align-items:center;margin-bottom:10px;">
                <button id="backToMainFromAviator" class="btn-primary" style="padding:10px 20px;font-size:16px;background: linear-gradient(90deg, #1a2333, #22304a);color:#fff;border:none;border-radius:10px;cursor:pointer;transition:transform 0.18s cubic-bezier(.2,.8,.2,1), background 0.22s;" data-btn-text="На главную" data-i18n="На главную">На главную</button>
                <button id="nextBtn"
                  style="padding:10px 20px;font-size:16px;color:#fff;background: linear-gradient(90deg, #00d9ff, #0066ff);border:none;border-radius:10px;cursor:pointer;transition:transform 0.18s cubic-bezier(.2,.8,.2,1), background 0.22s;" data-btn-text="Далее" data-i18n="Далее">Далее</button>
              </div>
              <div class="abw-main">
                <div class="abw-left">
                  <div class="abw-amount-control">
                    <button class="abw-circle" data-action="minus" data-i18n="minus">−</button>
                    <div class="abw-amount-display">
                      <div class="abw-amount-value"><span id="abwAmount">0.10</span></div>
                      <div class="abw-currency">EUR</div>
                    </div>
                    <button class="abw-circle" data-action="plus" data-i18n="plus">+</button>
                  </div>
                  <div class="abw-presets">
                    <button class="abw-chip" data-value="0.01" data-i18n="chip_001">0.01</button>
                    <button class="abw-chip" data-value="0.1" data-i18n="chip_01">0.10</button>
                    <button class="abw-chip" data-value="0.5" data-i18n="chip_05">0.50</button>
                    <button class="abw-chip" data-value="1" data-i18n="chip_1">1</button>
                    <button class="abw-chip" data-value="5" data-i18n="chip_5">5</button>
                    <button class="abw-chip" data-value="10" data-i18n="chip_10">10</button>
                  </div>
                </div>
                <div class="abw-action">
                  <!-- Поле для ввода ставки -->
                  <input 
                    type="number" 
                    id="abwInput" 
                    min="0.01" 
                    max="200" 
                    step="0.01" 
                    value="0.10"
                    style="width:120px;height:45px;font-size:15px;color:#fff;background:#0a0f1f;border:2px solid transparent;border-radius:12px;outline:none;text-align:center;background-image: linear-gradient(#0a0f1f, #0a0f1f),linear-gradient(90deg, #00d9ff, #0066ff);background-origin: border-box;background-clip: padding-box, border-box;box-shadow:0 0 10px rgba(0,153,255,0.6),0 0 20px rgba(0,153,255,0.4);transition:box-shadow 0.3s;"
                    onfocus="this.style.boxShadow='0 0 15px rgba(0,204,255,0.8), 0 0 30px rgba(0,102,255,0.7), 0 0 50px rgba(0,153,255,0.5)';"
                    onblur="this.style.boxShadow='0 0 10px rgba(0,153,255,0.6), 0 0 20px rgba(0,153,255,0.4)';"
                  >
                </div>
                <!-- Кнопка ставки -->
                <button id="abwPlaceBtn">
                  <div class="abw-btn-title" data-i18n="Ставка">Ставка</div>
                  <div class="abw-btn-amount"><span id="abwBtnAmount">0.10</span> <span data-i18n="EUR">EUR</span></div>
                </button>
              </div>
            </div>
          </div>
        </div>
        <div class="controls">
          
        </div>
      </section>
<div id="userNameWarning" style="color:#ff3a3a;font-size:13px;margin-top:4px;display:none;">Введите имя, чтобы продолжить</div>
      <!-- STEP 4: Aviator — вкладка 2 (пустая) -->
      <section class="step" id="step-4">
        <div>
         
          <h3 style="margin:0 0 8px 0" data-i18n="aviator">Aviator</h3>
          <button class="btn-primary" id="backToBetFrom4" style="margin-bottom:14px;max-width:180px" data-i18n="← Назад">← Назад</button>
          <div class="wrap">

<div class="title">
<div class="logo">LC</div>
<div>
<h1 data-i18n="Подборка точного коэффициента">Подборка точного коэффициента</h1>

</div>
</div>


<div class="display" style="margin-top:12px">
<div>
<div class="coeff" aria-live="polite">
  <div class="num" id="coeffDisplay">—</div>
</div>

</div>
<div style="display:flex;flex-direction:column;align-items:flex-end;gap:10px">
<div class="meter" aria-hidden="true"><i id="meterBar"></i></div>
<div class="small status" id="status" data-i18n="ready">Готов</div>

</div>
</div>


<div class="controls">

<button id="pickBtn" class="btn pulse" data-i18n="Подобрать коэффициент">Подобрать коэффициент</button>
<div style="flex:1"></div>
</div>


<div id="particles"></div>

  </div>
</div>
        </div>

<script>
// === Aviator ручной ввод (step-4) ===
document.addEventListener('DOMContentLoaded', function() {
  const aviatorInput = document.getElementById('aviatorInput');
  const aviatorInputDisplay = document.getElementById('aviatorInputDisplay');
  const abwBtnAmount = document.getElementById('abwBtnAmount');
  if (!aviatorInput || !aviatorInputDisplay || !abwBtnAmount) return;

  aviatorInput.addEventListener('keydown', (e) => {
    if (e.key === 'Enter') {
      let value = aviatorInput.value;
      aviatorInputDisplay.textContent = value === '' ? '--' : value;
      abwBtnAmount.textContent = value === '' ? '--' : value;
    }
  });
});

// Добавляем data-btn-text для кнопок с нужным текстом
document.addEventListener('DOMContentLoaded', function() {   
  const btnTexts = ['Далее', 'Далее →', '← Назад', 'Назад', 'На главную', 'СОХРАНИТЬ', 'ПОЛУЧИТЬ СТУПЕНЬ', 'Очистить историю'];
  document.querySelectorAll('button').forEach(function(btn) {
    const txt = btn.textContent.trim();
    if (btnTexts.includes(txt)) {
      btn.setAttribute('data-btn-text', txt);
    }
  });
  // Назначаем обработчик для кнопки "На главную" на вкладке ставки
  var backBtn = document.getElementById('backToMainFromAviator');
  if (backBtn) {
    backBtn.addEventListener('click', function() {
      if (typeof showStep === 'function') {
        showStep(0);
      } else {
        document.querySelectorAll('.step').forEach(s => s.classList.remove('active'));
        var s0 = document.getElementById('step-0');
        if (s0) s0.classList.add('active');
        document.querySelectorAll('.step-dot').forEach(d => d.classList.remove('active'));
        var d0 = document.querySelector('.step-dot[data-step="0"]');
        if (d0) d0.classList.add('active');
      }
    });
  }
});
        // Кнопка "Назад" для step-4 (подбор коэффициента)
        document.addEventListener('DOMContentLoaded', function() {
          var btn = document.getElementById('backToBetFrom4');
          if (btn) {
            btn.addEventListener('click', function() {
              if (typeof showStep === 'function') {
                showStep(3);
              } else {
                // fallback: скрыть все шаги и показать step-4 вручную
                document.querySelectorAll('.step').forEach(s => s.classList.remove('active'));
                var s4 = document.getElementById('step-4');
                if (s4) s4.classList.add('active');
                document.querySelectorAll('.step-dot').forEach(d => d.classList.remove('active'));
                var d4 = document.getElementById('dot-4');
                if (d4) d4.classList.add('active');
              }
            });
          }
        });
        </script>
      </section>

      <!-- STEP 5: Aviator — вкладка 3 (пустая) -->
      <section class="step" id="step-5">
        <div>
          <h3 style="margin:0 0 8px 0">Aviator — вкладка 3 (пустая)</h3>
          <p style="color:var(--muted);font-size:13px">Пустая — конец последовательности Aviator.</p>
        </div>
        <div style="display:flex;gap:12px;align-items:center;">
  <button class="btn-ghost" data-back-to="4">← Назад</button>
  <button class="btn-primary" data-back-to="0" data-i18n="На главную">На главную</button>

  <!-- Кнопка запуска -->
  <button id="pickCoefBtn" style="margin-left:6px;padding:8px 12px;border-radius:10px;border:1px dashed rgba(110,240,255,0.12);background:transparent;cursor:pointer;font-weight:700;">
    Подобрать коэффициент
  </button>
</div>
 <!-- Простой модал (вложен в step-5, поэтому локален) -->
<div id="coefPopup" aria-hidden="true" style="display:none;">

  <div style="font-weight:700;font-size:15px">Результат подбора</div>
  <div style="font-size:12px;color:var(--muted)">Диапазон 1.20x — 7.54x</div>
  <button id="closeCoef" style="background:transparent;border:none;cursor:pointer;font-size:18px">✕</button>
</div>

  <div id="coefRow" style="display:flex;gap:8px;flex-wrap:wrap;margin-top:12px;">
    <!-- сгенерированные элементы появятся здесь -->
  </div>

  <div style="display:flex;justify-content:space-between;align-items:center;margin-top:10px;">
    <div style="font-size:13px;color:var(--muted)">Выбрано:</div>
    <div id="chosenCoef" style="font-weight:800;font-size:18px">—</div>
  </div>

  <div style="margin-top:10px;display:flex;gap:8px;">
    <button id="genCoef" class="btn-primary" style="padding:8px 12px;border-radius:10px;">Сгенерировать</button>
    <button id="acceptCoef" class="btn-ghost" style="padding:8px 12px;border-radius:10px;">Принять</button>
  </div>
</div>
       
      </section>

    </div>

    <aside class="aside">
      <div class="widget">
       <h3 data-i18n="Информация">Информация</h3>
  <p style="color:var(--muted);font-size:13px" data-i18n="Выбранная игра:">Выбранная игра: <strong id="selectedGame" data-i18n="selected_game_value">—</strong></p>
        <p style="color:var(--muted);font-size:13px">Имя: <strong id="selectedName">—</strong></p>
      </div>

      <div class="widget">
        <h3>Баланс</h3>
        <div style="display:flex;align-items:center;justify-content:space-between">
          <div>
            <div style="color:var(--muted);font-size:13px">Доступно</div>
            <div class="balance-amount" id="asideBalance">$0.00</div>
          </div>
          <div style="text-align:right;color:var(--muted);font-size:12px">Только для Chicken</div>
        </div>
      </div>

    <div class="widget">
  <h3 data-i18n="Советы">Советы</h3>
  <ul style="margin:0;padding-left:18px;color:var(--muted);font-size:13px">
    <li data-i18n="Ставка идет от 0.01 до 200 EUR"  >Ставка идет от 0.01 до 200 EUR</li>
    <li data-i18n="Делай ставку идентичную, как на VAVADA">Делай ставку идентичную, как на VAVADA</li>
  </ul>
</div>

      <div id="currencyBox" style="margin-top:16px;padding:10px 14px;border:1.5px solid #2dd4bf;border-radius:12px;display:flex;gap:10px;justify-content:center;align-items:center;background:rgba(45,212,191,0.06);">
        <span style="font-size:13px;color:var(--muted);margin-right:8px;" data-i18n="Валюта:">Валюта:</span>
  <button class="currency-btn" data-currency="RUB" style="padding:6px 14px;border-radius:8px;border:0;background:#19202b;color:#fff;font-weight:600;cursor:pointer;">RUB</button>
  <button class="currency-btn" data-currency="KZT" style="padding:6px 14px;border-radius:8px;border:0;background:#19202b;color:#fff;font-weight:600;cursor:pointer;">KZT</button>
        <button class="currency-btn" data-currency="EUR" style="padding:6px 14px;border-radius:8px;border:0;background:#19202b;color:#fff;font-weight:600;cursor:pointer;">EUR</button>
  <button class="currency-btn" data-currency="USD" style="padding:6px 14px;border-radius:8px;border:0;background:#19202b;color:#fff;font-weight:600;cursor:pointer;">USD</button>
      </div>
      <!-- Мини-окошко выбора языка -->
  <div id="langBox" style="margin-top:12px;padding:10px 14px;border:1.5px solid #2dd4bf;border-radius:12px;display:flex;gap:10px;justify-content:center;align-items:center;background:rgba(45,212,191,0.06);">
  <span style="font-size:14px;color:var(--muted);margin-right:8px;" data-i18n="Выбор языка:">Выбор языка:</span>
  <button class="lang-btn" data-lang="RUS" style="padding:5px 14px;border-radius:8px;border:0;background:#19202b;color:#fff;font-weight:600;cursor:pointer;transition:background 0.18s, color 0.18s;font-size:15px;">RUS</button>
  <button class="lang-btn" data-lang="ENG" style="padding:5px 14px;border-radius:8px;border:0;background:#19202b;color:#fff;font-weight:600;cursor:pointer;transition:background 0.18s, color 0.18s;font-size:15px;">ENG</button>
  <button class="lang-btn" data-lang="KZT" style="padding:5px 14px;border-radius:8px;border:0;background:#19202b;color:#fff;font-weight:600;cursor:pointer;transition:background 0.18s, color 0.18s;font-size:15px;">KZT</button>
      </div>
   
 
    </aside>
  </div>
  <style>
    .lang-btn:hover {
      background: linear-gradient(90deg, #0a1a3f 0%, #22304a 100%) !important;
      color: #fff !important;
      box-shadow: 0 2px 10px rgba(0,40,80,0.18);
      transform: scale(1.08);
      transition: all 0.18s cubic-bezier(.2,.8,.2,1);
    }
  </style>

  <script>
    // === Мультиязычность ===
    const translations = {
      KAZ: {
        'Делай ставку идентичную, как на VAVADA': 'VAVADA-дағыдай дәл ставка жасаңыз',
        'Выберите сумму': 'Соманы таңдаңыз',
        'Ставка': 'Бәс',
        'Выбор языка:': 'Тілді таңдау:',
        'На главную': 'Басты бетке',
        'Валюта:': 'Aқша:',
        'Проверка имени на VAVADA…': 'VAVADA-да есімді тексеру…',
        'Далее →': 'Келесі →',
        '← Назад': '← Артқа',
        'Далее': 'Келесі →',
        'СТАРТ': 'Бастау',
        'ОТМЕНИТЬ': 'Бас тарту',
        'Сетка': 'Тор',
        'Кол-во мин': 'Миналар саны',
        'Сумма ставки': 'Бәс сомасы',
        'Имя пользователя VAVADA': 'VAVADA пайдаланушы аты',
        'Введите имя пользователя VAVADA': 'VAVADA пайдаланушы атын енгізіңіз',
        'Выбор игр': 'Ойын таңдау',
        'Пользователь:': 'Пайдаланушы:',
        'Текущий баланс': 'Ағымдағы баланс',
        'Баланс': 'Баланс',
        'Советы': 'Кеңестер',
        'Ставка идет от 0.01 до 200 EUR': 'Бәс 0.01-ден 200 EUR-ға дейін',
        'Ставка идет от 10 до 10 000 ₽': 'Бәс 10-нан 10 000 ₽-ға дейін',
        'Ставка идет от 0,1 до 120 $': 'Бәс 0,1-ден 120 $-ға дейін',
        'Ставка идет от 0,1 до 105 €': 'Бәс 0,1-ден 105 €-ға дейін',
        'Ставка идет от 66 до 66 000 ₸': 'Бәс 66-дан 66 000 ₸-ға дейін',
        'Ставка идет от 0,1 до 100': 'Бәс 0,1-ден 100-ға дейін',
        'Chicken Road 2': 'Chicken Road 2',
        'Aviator': 'Aviator',
        'Turbo Mines': 'Turbo Mines',
        'Введите никнейм чтобы продолжить!': 'Жалғастыру үшін лақап атыңызды енгізіңіз!',
        'СОХРАНИТЬ': 'Сақтау',
        'ПОЛУЧИТЬ СТУПЕНЬ': 'Деңгейді алу',
        'Очистить историю': 'Тарихты тазалау',
        'Информация': 'Ақпарат',
        'Выбранная игра:': 'Таңдалған ойын:',
        'Имя:': 'Аты:',
        'Доступно': 'Қол жетімді',
        'Только для Chicken': 'Тек Chicken үшін',
        'Советы': 'Кеңестер',
        'Подборка точного коэффициента': 'Дәл коэффициентті таңдау',
        'Готов': 'Дайын',
        'Подобрать коэффициент': 'Коэффициентті таңдау',
        'Сгенерировать': 'Генерациялау',
        'Принять': 'Қабылдау',
        'Выбрано:': 'Таңдалды:',
        'История пуста': 'Тарих бос',
        'Сохранено ✓': 'Сақталды ✓',
        'ENG': 'Ағылшын',
        'KZT': 'Қазақша',
        'RUS': 'Орысша',
      },
      RUS: {
        'Выбор языка:': 'Выбор языка:',
        'Валюта:': 'Валюта:',
        'Далее →': 'Далее →',
        '← Назад': '← Назад',
        'СТАРТ': 'СТАРТ',
        'ОТМЕНИТЬ': 'ОТМЕНИТЬ',
        'Сетка': 'Сетка',
        'Кол-во мин': 'Кол-во мин',
        'Сумма ставки': 'Сумма ставки',
        'Имя пользователя VAVADA': 'Имя пользователя VAVADA',
        'Введите имя пользователя VAVADA': 'Введите имя пользователя VAVADA',
        'Выбор игр': 'Выбор игр',
        'Пользователь:': 'Пользователь:',
        'Текущий баланс': 'Текущий баланс',
        'Баланс': 'Баланс',
        'Советы': 'Советы',
        'Ставка идет от 0.01 до 200 EUR': 'Ставка идет от 0.01 до 200 EUR',
        'Chicken Road 2': 'Chicken Road 2',
        'Aviator': 'Aviator',
        'Turbo Mines': 'Turbo Mines',
        'На главную': 'На главную',
        'СОХРАНИТЬ': 'СОХРАНИТЬ',
        'ПОЛУЧИТЬ СТУПЕНЬ': 'ПОЛУЧИТЬ СТУПЕНЬ',
        'Очистить историю': 'Очистить историю',
        'ENG': 'ENG',
        'KZT': 'KZT',
        'RUS': 'RUS',
      },
      ENG: {
        'Проверка имени на VAVADA…': 'Checking name on VAVADA…',
        'Ставка': 'Bet',
        'Выберите сумму': 'Select amount',
        'Делай ставку идентичную, как на VAVADA': 'Place a bet identical to the one on VAVADA',
        'Выбор языка:': 'Language:',
        'Валюта:': 'Currency:',
        'Далее →': 'Next →',
        'Далее': 'Next →',
        '← Назад': '← Back',
        'СТАРТ': 'START',
        'ОТМЕНИТЬ': 'CANCEL',
        'Сетка': 'Grid',
        'Введите никнейм чтобы продолжить!': 'Enter your nickname to continue!',
        'Кол-во мин': 'Mines count',
        'Сумма ставки': 'Bet amount',
        'Имя пользователя VAVADA': 'VAVADA Username',
        'Введите имя пользователя VAVADA': 'Enter VAVADA username',
        'Выбор игр': 'Game selection',
        'Пользователь:': 'User:',
        'Текущий баланс': 'Current balance',
        'Баланс': 'Balance',
        'Советы': 'Tips',
        'Ставка идет от 0.01 до 200 EUR': 'Bet range: 0.01 to 200 EUR',
        'Ставка идет от 10 до 10 000 ₽': 'Bet range: 10 to 10,000 ₽',
        'Ставка идет от 0,1 до 120 $': 'Bet range: 0.1 to 120 $',
        'Ставка идет от 0,1 до 105 €': 'Bet range: 0.1 to 105 €',
        'Ставка идет от 66 до 66 000 ₸': 'Bet range: 66 to 66,000 ₸',
        'Ставка идет от 0,1 до 100': 'Bet range: 0.1 to 100',
        'Chicken Road 2': 'Chicken Road 2',
        'Aviator': 'Aviator',
        'Turbo Mines': 'Turbo Mines',
        'На главную': 'Home',
        'СОХРАНИТЬ': 'SAVE',
        'ПОЛУЧИТЬ СТУПЕНЬ': 'GET STEP',
        'Очистить историю': 'Clear history',
        'Информация': 'Information',
        'Выбранная игра:': 'Selected game:',
        'Имя:': 'Name:',
        'Доступно': 'Available',
        'Только для Chicken': 'Only for Chicken',
        'Советы': 'Tips',
        'Подборка точного коэффициента': 'Exact coefficient selection',
        'Готов': 'Ready',
        'Подобрать коэффициент': 'Pick coefficient',
        'Сгенерировать': 'Generate',
        'Принять': 'Accept',
        'Выбрано:': 'Chosen:',
        'История пуста': 'History is empty',
        'Сохранено ✓': 'Saved ✓',
        'ENG': 'ENG',
        'KZT': 'KZT',
        'RUS': 'RUS',
      }
    };

    function translateSite(lang) {
      const dict = translations[lang] || translations['RUS'];
      document.querySelectorAll('[data-i18n]').forEach(el => {
        const key = el.getAttribute('data-i18n');
        if (dict[key]) {
          // Для input и textarea переводим placeholder
          if (el.tagName === 'INPUT' || el.tagName === 'TEXTAREA') {
            el.placeholder = dict[key];
          } else if (el.tagName === 'SELECT') {
            // Для select переводим options
            Array.from(el.options).forEach(opt => {
              if (dict[opt.textContent.trim()]) opt.textContent = dict[opt.textContent.trim()];
            });
          } else {
            el.textContent = dict[key];
          }
        }
      });
      // Переводим все кнопки с data-i18n
      document.querySelectorAll('button[data-i18n]').forEach(btn => {
        const key = btn.getAttribute('data-i18n');
        if (dict[key]) btn.textContent = dict[key];
      });
      // Перевод всех option внутри select
      document.querySelectorAll('select option').forEach(opt => {
        const key = opt.textContent.trim();
        if (dict[key]) opt.textContent = dict[key];
      });
      // Перевод всех элементов с data-i18n-placeholder
      document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
        const key = el.getAttribute('data-i18n-placeholder');
        if (dict[key]) el.placeholder = dict[key];
      });
      // Перевод выбранной игры
      const selectedGameEl = document.getElementById('selectedGame');
      if (selectedGameEl) {
        const gameKey = selectedGameEl.textContent.trim();
        if (dict[gameKey]) selectedGameEl.textContent = dict[gameKey];
      }
    }

    document.addEventListener('DOMContentLoaded', function() {
      const langBtns = document.querySelectorAll('.lang-btn');
      function setLang(lang) {
        // Если выбран KZT, используем ключ 'KAZ' для переводов
        const realLang = (lang === 'KZT') ? 'KAZ' : lang;
        localStorage.setItem('vavada_lang', lang); // Сохраняем выбранный язык
        langBtns.forEach(btn => {
          if (btn.dataset.lang === lang) {
            btn.style.background = 'linear-gradient(90deg,#2dd4bf,#60a5fa)';
            btn.style.color = '#021225';
          } else {
            btn.style.background = '#19202b';
            btn.style.color = '#fff';
          }
        });
        translateSite(realLang);
      }
      langBtns.forEach(btn => {
        btn.addEventListener('click', function() {
          setLang(btn.dataset.lang);
          // Переход на главный экран
          if (typeof showStep === 'function') {
            showStep(0);
          } else {
            document.querySelectorAll('.step').forEach(s => s.classList.remove('active'));
            var s0 = document.getElementById('step-0');
            if (s0) s0.classList.add('active');
            document.querySelectorAll('.step-dot').forEach(d => d.classList.remove('active'));
            var d0 = document.querySelector('.step-dot[data-step="0"]');
            if (d0) d0.classList.add('active');
          }
          // Перезагрузка страницы через 1.5 секунды для полного перевода
          setTimeout(function() {
            window.location.reload();
          }, 1500);
        });
      });
      // Инициализация: восстанавливаем язык из localStorage
      const savedLang = localStorage.getItem('vavada_lang') || 'RUS';
      setLang(savedLang);
    });
    const currencyMap = {
      RUB: { symbol: '₽', label: 'RUB', code: 'RUB' },
      KZT: { symbol: '₸', label: 'KZT', code: 'KZT' },
      EUR: { symbol: 'EUR', label: 'EUR', code: 'EUR' },
      USD: { symbol: '$', label: 'USD', code: 'USD' },
    };
    // currencyLimits уже объявлен выше, это объявление удалено
    function getAdvice(cur) {
      const lim = currencyLimits[cur];
      const sym = currencyMap[cur].symbol;
      // Формат: для RUB/KZT без копеек, для EUR/USD с двумя знаками

      if (cur === 'RUB' || cur === 'KZT') {
        return `Ставка идет от ${lim.min} до ${lim.max} ${sym}`;
      } else {
        return `Ставка идет от ${lim.min.toFixed(2)} до ${lim.max} ${sym}`;
      }
    }
    function getMinMaxString(cur) {
      const lim = currencyLimits[cur];
      const sym = currencyMap[cur].symbol;
      if (cur === 'RUB' || cur === 'KZT') {
        return `(мин ${lim.min} ${sym} — макс ${lim.max} ${sym})`;
      } else {
        return `(мин ${sym}${lim.min.toFixed(2)} — макс ${sym}${lim.max})`;
      }
    }
    function getCurrency() {
      return localStorage.getItem('vavada_currency') || 'EUR';
    }
    function setCurrency(cur) {
      localStorage.setItem('vavada_currency', cur);
    }
    function updateCurrencyUI() {
      const cur = getCurrency();
      // 1. Подсветка выбранной кнопки
      document.querySelectorAll('.currency-btn').forEach(btn => {
        if (btn.dataset.currency === cur) {
          btn.style.background = 'linear-gradient(90deg,#2dd4bf,#60a5fa)';
          btn.style.color = '#021225';
        } else {
          btn.style.background = '#19202b';
          btn.style.color = '#fff';
        }
      });
      // 2. Советы (первый li) — динамический перевод для всех валют
      const adviceLi = document.querySelector('.widget ul li[data-i18n]');
      const langRaw = localStorage.getItem('vavada_lang') || 'RUS';
      const lang = langRaw === 'KZT' ? 'KAZ' : langRaw;
      let i18nKey = '';
      if (cur === 'EUR') i18nKey = 'Ставка идет от 0.01 до 200 EUR';
      else if (cur === 'USD') i18nKey = 'Ставка идет от 0,1 до 120 $';
      else if (cur === 'RUB') i18nKey = 'Ставка идет от 10 до 10 000 ₽';
      else if (cur === 'KZT') i18nKey = 'Ставка идет от 66 до 66 000 ₸';
      adviceLi.setAttribute('data-i18n', i18nKey);
      // Переводим совет на выбранный язык
      if (translations[lang] && translations[lang][i18nKey]) {
        adviceLi.textContent = translations[lang][i18nKey];
      } else {
        adviceLi.textContent = i18nKey;
      }
      // 3. Aviator: подписи валюты
      document.querySelectorAll('.abw-currency').forEach(el => {
        el.textContent = currencyMap[cur].symbol;
      });
      // 4. Aviator: кнопка ставки
      const abwBtnAmount = document.getElementById('abwBtnAmount');
      if (abwBtnAmount && abwBtnAmount.parentElement) {
        abwBtnAmount.parentElement.innerHTML = `<span id=\"abwBtnAmount\">${abwBtnAmount.textContent}</span> ${currencyMap[cur].symbol}`;
      }
      // 5. Баланс (главный экран, aside)
      const balanceDisplay = document.getElementById('balanceDisplay');
      if (balanceDisplay) {
        // Получаем только число (сохраняем копейки)
        let val = balanceDisplay.textContent.replace(/[^\d.,]/g, '');
        // Формируем строку: знак валюты слитно с числом
        balanceDisplay.textContent = `${currencyMap[cur].symbol}${val}`;
      }
      // 6. Aside баланс (если не скрыт)
      const asideBalance = document.getElementById('asideBalance');
      if (asideBalance) {
        let val = asideBalance.textContent.replace(/[^\\d.,]/g, '');
        asideBalance.textContent = `${currencyMap[cur].symbol}${val}`;
      }
      // 7. Везде где есть \"EUR\" в ставках (например, input placeholder)
      const abwInput = document.getElementById('abwInput');
      if (abwInput) abwInput.placeholder = `Сумма (${currencyMap[cur].symbol})`;
  // 8. min/max строка
  const minmax = document.getElementById('minmaxCurrency');
  if (minmax) minmax.textContent = getMinMaxString(cur);
    }
    document.addEventListener('DOMContentLoaded', function() {
      // Клик по валюте
      document.querySelectorAll('.currency-btn').forEach(btn => {
        btn.addEventListener('click', function() {
          setCurrency(btn.dataset.currency);
          updateCurrencyUI();
          // Перезагрузка страницы через 1.5 секунды после выбора новой валюты
          setTimeout(function() {
            window.location.reload();
          }, 1500);
        });
      });
      updateCurrencyUI();
    });
    // Элементы
    const username = document.getElementById('username');
    const userDisplay = document.getElementById('userDisplay');
    const selectedName = document.getElementById('selectedName');
    const gameSelect = document.getElementById('gameSelect');
    const selectedGame = document.getElementById('selectedGame');

    const steps = Array.from(document.querySelectorAll('.step'));
    const dots = Array.from(document.querySelectorAll('.step-dot'));

    const dot1 = document.getElementById('dot-1'); // balance (chicken)
    const dot2 = document.getElementById('dot-2'); // chicken generator
    const dot3 = document.getElementById('dot-3'); // aviator 1
    const dot4 = document.getElementById('dot-4'); // aviator 2
  const dot5 = document.getElementById('dot-5'); // aviator 3
  const dot8 = document.getElementById('dot-8'); // turbo mines 1
  const dot9 = document.getElementById('dot-9'); // turbo mines 2

    let curStep = 0;

    const amountNumber = document.getElementById('amountNumber');
    const amountRange = document.getElementById('amountRange');
    const saveBtn = document.getElementById('saveBtn');
    const balanceDisplay = document.getElementById('balanceDisplay');
    const asideBalance = document.getElementById('asideBalance');

    const dieFace = document.getElementById('dieFace');
    const genBtn = document.getElementById('genBtn');
    const historyEl = document.getElementById('history');
    const clearHistory = document.getElementById('clearHistory');

    // Показать шаг
    function showStep(i){
      const dot = dots.find(d => parseInt(d.dataset.step,10) === i);
      if(dot && dot.classList.contains('hidden')){
        alert('Эта вкладка доступна только в соответствующем режиме');
        return;
      }
      steps.forEach(s => s.classList.remove('active'));
      dots.forEach(d => d.classList.remove('active'));
      const s = document.getElementById(`step-${i}`);
      if(s) s.classList.add('active');
      if(dot) dot.classList.add('active');
      curStep = i;
      // При входе на вкладку 1 (баланс Chicken) обновлять валюту баланса
      if (i === 1 && typeof updateCurrencyUI === 'function') {
        updateCurrencyUI();
      }
    }

    function isDotHidden(idx){
      const d = dots.find(x => parseInt(x.dataset.step,10) === idx);
      return d ? d.classList.contains('hidden') : true;
    }

    // Показ/скрытие вкладок в зависимости от режима
    function toggleModeTabs(mode){
      // скрываем все mode-specific
      [dot1,dot2,dot3,dot4,dot5,dot8,dot9].forEach(d => d && d.classList.add('hidden'));
      const dot6 = document.getElementById('dot-6');
      const dot7 = document.getElementById('dot-7');
      dot6 && dot6.classList.add('hidden');
      dot7 && dot7.classList.add('hidden');

      if(mode === 'chicken'){
        dot1 && dot1.classList.remove('hidden'); // баланс
        dot2 && dot2.classList.remove('hidden'); // генератор
      } else if(mode === 'aviator'){
        dot3 && dot3.classList.remove('hidden'); // aviator 1
        dot4 && dot4.classList.remove('hidden'); // aviator 2
        dot5 && dot5.classList.remove('hidden'); // aviator 3
      } else if(mode === 'turbo'){
        dot8 && dot8.classList.remove('hidden'); // turbo mines 1
        dot9 && dot9.classList.remove('hidden'); // turbo mines 2
      }

      // если текущая точка скрыта — вернуть на главную (0)
      const curDot = dots.find(d => parseInt(d.dataset.step,10) === curStep);
      if(curDot && curDot.classList.contains('hidden')) showStep(0);
    }

    // Найти первый видимый шаг > fromIndex
    function nextVisibleStep(fromIndex){
      const candidates = dots.map(d => parseInt(d.dataset.step,10)).filter(n => n > fromIndex).sort((a,b)=>a-b);
      for(const idx of candidates){
        if(!isDotHidden(idx)) return idx;
      }
      return null;
    }

    // Навигация
    document.getElementById('toNextFrom0').addEventListener('click', ()=>{
      // сохраняем профиль перед переходом
      saveProfile();
      const nxt = nextVisibleStep(0);
      if(nxt !== null) showStep(nxt);
      else alert('Нет доступных вкладок для выбранной игры');
    });

    // Делегирование кнопок внутри вкладок
    document.body.addEventListener('click', (e)=>{
      const t = e.target;
      if(t.matches('[data-next-to]')){ showStep(parseInt(t.getAttribute('data-next-to'),10)); }
      else if(t.matches('[data-back-to]')){ showStep(parseInt(t.getAttribute('data-back-to'),10)); }
      else if(t.matches('[data-back-home]')){ showStep(0); }
    });

    document.getElementById('resetAll').addEventListener('click', ()=>{
      if(confirm('Сбросить все данные (имя, баланс, история)?')){
        localStorage.removeItem('vavada_username');
        localStorage.removeItem('vavada_balance');
        localStorage.removeItem('vavada_history');
        localStorage.removeItem('vavada_game');
        username.value = '';
        gameSelect.value = 'chicken';
        toggleModeTabs('chicken');
        updateUIFromStorage();
        alert('Данные сброшены');
      }
    });

    // Баланс: синхронизация ползунок/число
    // min/max для каждой валюты
    const currencyLimits = {
      RUB: { min: 10, max: 16500 },
      EUR: { min: 0.01, max: 200 },
      USD: { min: 0.01, max: 230 },
      KZT: { min: 20, max: 110000 }
    };

    function getLimits() {
      const cur = getCurrency();
      return currencyLimits[cur] || currencyLimits['EUR'];
    }

    function clampAmount(v) {
      const { min, max } = getLimits();
      let n = parseFloat(v);
      if (isNaN(n)) n = min;
      n = Math.max(min, Math.min(max, Math.round(n * 100) / 100));
      return n;
    }

    function updateAmountInputs() {
      const { min, max } = getLimits();
      if (amountNumber) {
        amountNumber.min = min;
        amountNumber.max = max;
        amountNumber.value = clampAmount(amountNumber.value).toFixed(2);
      }
      if (amountRange) {
        amountRange.min = min;
        amountRange.max = max;
        amountRange.value = clampAmount(amountRange.value);
      }
    }

    amountNumber && amountNumber.addEventListener('input', ()=>{
      if (amountNumber.value === "") {
        // Разрешаем оставить поле пустым для ручного ввода
        amountRange.value = "";
        return;
      }
      const v = clampAmount(amountNumber.value);
      amountNumber.value = v.toFixed(2);
      amountRange.value = v;
    });

    // Красиво очищать поле суммы по Enter (без ошибок и авто-восстановления)
    amountNumber && amountNumber.addEventListener('keydown', (e) => {
      if (e.key === 'Enter') {
        amountNumber.value = '';
        amountRange.value = '';
        // Не сбрасываем на min, не вызываем clampAmount
      }
    });
    amountRange && amountRange.addEventListener('input', ()=>{
      const v = clampAmount(amountRange.value);
      amountRange.value = v;
      amountNumber.value = parseFloat(v).toFixed(2);
    });

    // При смене валюты обновлять лимиты и значения
    document.addEventListener('DOMContentLoaded', function() {
      updateCurrencyUI();
      updateAmountInputs();
      document.querySelectorAll('.currency-btn').forEach(btn => {
        btn.addEventListener('click', function() {
          updateAmountInputs();
        });
      });
    });
    // При смене валюты обновлять баланс
    document.addEventListener('DOMContentLoaded', function() {
      updateCurrencyUI();
    });

    saveBtn && saveBtn.addEventListener('click', ()=>{
      const v = clampAmount(amountNumber.value);
      localStorage.setItem('vavada_balance', v.toFixed(2));
      updateUIFromStorage();
      // Обновить валюту в балансе сразу после сохранения
      if (typeof updateCurrencyUI === 'function') updateCurrencyUI();
      saveBtn.textContent = 'Сохранено ✓';
      setTimeout(()=> saveBtn.textContent = 'СОХРАНИТЬ', 1200);
    });

    // Профиль
    function saveProfile(){ const name = (username.value||'').trim(); localStorage.setItem('vavada_username', name); localStorage.setItem('vavada_game', gameSelect.value); updateUIFromStorage(); }
    username.addEventListener('blur', saveProfile);
    gameSelect.addEventListener('change', ()=>{
      saveProfile();
      toggleModeTabs(gameSelect.value);
      // При смене режима обновлять совет
      if (typeof updateCurrencyUI === 'function') updateCurrencyUI();
    });

    // Генератор для Chicken
    function rollDie(){ const n = Math.floor(Math.random()*6)+1; dieFace.style.transform = 'rotateX(720deg) rotateY(360deg)'; dieFace.style.transition = 'transform 700ms cubic-bezier(.2,.8,.2,1)'; setTimeout(()=>{ dieFace.style.transform = 'none'; },700); dieFace.textContent = n; const hist = JSON.parse(localStorage.getItem('vavada_history')||'[]'); hist.unshift({n, at: Date.now()}); localStorage.setItem('vavada_history', JSON.stringify(hist.slice(0,30))); renderHistory(); return n; }
    genBtn && genBtn.addEventListener('click', ()=>{ if(isDotHidden(2)){ alert(''); return; } const out = rollDie(); genBtn.disabled = true; setTimeout(()=> genBtn.disabled = false, 700); });

    clearHistory && clearHistory.addEventListener('click', ()=>{ if(confirm('Clear history?')){ localStorage.removeItem('vavada_history'); renderHistory(); } });

    function renderHistory(){ const hist = JSON.parse(localStorage.getItem('vavada_history')||'[]'); historyEl.innerHTML = ''; if(hist.length===0){ historyEl.innerHTML = '<div style=\"color:var(--muted);font-size:13px\" data-i18n="История пуста"></div>'; return } hist.forEach(entry=>{ const d = new Date(entry.at); const el = document.createElement('div'); el.innerHTML = `<span class=\"chip\">${entry.n}</span> <small style=\"color:var(--muted)\">${d.toLocaleString()}</small>`; historyEl.appendChild(el); }) }

    // Обновление UI из localStorage
    function updateUIFromStorage(){
      const name = localStorage.getItem('vavada_username')||'';
      const game = localStorage.getItem('vavada_game')||gameSelect.value;
      const balance = parseFloat(localStorage.getItem('vavada_balance')||'0').toFixed(2);
      username.value = name;
      userDisplay.textContent = name || '—';
      selectedName.textContent = name || '—';
      gameSelect.value = game;
      const gameNames = {chicken:'Chicken Road 2', aviator:'Aviator', penalty:'Penalty Unlimited', turbo:'Turbo Mines'};
      selectedGame.textContent = gameNames[game] || '—';
      toggleModeTabs(game);
      balanceDisplay.textContent = `$${parseFloat(balance).toFixed(2)}`;
      asideBalance.textContent = `$${parseFloat(balance).toFixed(2)}`;
      renderHistory();
    }

    // Инициализация
    (function init(){
      const b = parseFloat(localStorage.getItem('vavada_balance'));
      if(!isNaN(b) && b>0){ amountNumber.value = parseFloat(b).toFixed(2); amountRange.value = parseFloat(b); } else { amountNumber.value = '1.00'; amountRange.value = 1; }
      if(!localStorage.getItem('vavada_game')) localStorage.setItem('vavada_game','chicken');
      updateUIFromStorage();

      // клики по точкам
      dots.forEach(d => d.addEventListener('click', ()=>{
        if(d.classList.contains('hidden')) return;
        const step = parseInt(d.dataset.step,10);
        showStep(step);
      }));
      
    })();
   document.addEventListener('DOMContentLoaded', () => {
  const min = 1.37, max = 7.87;
  const display = document.getElementById('coeffDisplay');
  const btn = document.getElementById('pickBtn');
  const meter = document.getElementById('meterBar');
  const status = document.getElementById('status');
  const particlesRoot = document.getElementById('particles');

  // Защита: если какие-то элементы отсутствуют — выводим предупреждение и выходим,
  // чтобы не было ошибок в консоли.
  if (!display || !btn || !meter || !status || !particlesRoot) {
    console.warn('Подбор коэффициента: один или несколько DOM-элементов не найдены.', {
      display: !!display, btn: !!btn, meter: !!meter, status: !!status, particlesRoot: !!particlesRoot
    });
    return;
  }

  function fmt(n){ return n.toFixed(2).replace('.', ','); } // формат RU

  function rand(minV, maxV){ return Math.random() * (maxV - minV) + minV; }

  function easeOutCubic(t){ return 1 - Math.pow(1 - t, 3); }

  let animating = false;

  function startGeneration(){
    if (animating) return;
    animating = true;
    btn.disabled = true;
    btn.classList.add('animate');
    status.textContent = 'Подборка...';

    const startVal = rand(min, max);
    const targetVal = Math.round(rand(min, max) * 100) / 100;
    const duration = 2800 + Math.random() * 1200; // 2.8 - 4.0s
    const startTime = performance.now();

    const sparkleInterval = setInterval(spawnSparkle, 120);

    function frame(now){
      const t = Math.min(1, (now - startTime) / duration);
      const e = easeOutCubic(t);

      const jitterAmp = (1 - e) * 0.12;
      const jitter = (Math.random() * 2 - 1) * jitterAmp;

      const value = startVal + (targetVal - startVal) * e + jitter;
      const clamped = Math.min(max, Math.max(min, value));

      display.textContent = fmt(clamped) + ' x';
      const pct = ((clamped - min) / (max - min)) * 100;
      meter.style.width = pct + '%';

      if (t < 1) {
        requestAnimationFrame(frame);
      } else {
        clearInterval(sparkleInterval);
        finish(targetVal);
      }
    }

    requestAnimationFrame(frame);
  }

  function finish(finalVal){
    display.textContent = fmt(finalVal) + ' x';
    meter.style.width = ((finalVal - min) / (max - min) * 100) + '%';
    status.textContent = 'Готов — ' + fmt(finalVal) + 'x';

    burstConfetti();

    setTimeout(() => {
      animating = false;
      btn.disabled = false;
      btn.classList.remove('animate');
    }, 700);
  }

  function spawnSparkle(){
    const s = document.createElement('div');
    s.className = 'sparkle';
    particlesRoot.appendChild(s);
    const card = document.querySelector('.card');
    const rect = card ? card.getBoundingClientRect() : { left: window.innerWidth/2, top: window.innerHeight/2, width: 240, height: 160 };

    const x = Math.random() * rect.width;
    const y = Math.random() * (rect.height * 0.6);
    s.style.position = 'fixed';
    s.style.left = (rect.left + x) + 'px';
    s.style.top = (rect.top + y) + 'px';
    s.style.opacity = '1';
    const scale = 0.6 + Math.random() * 1.4;
    s.style.transform = 'scale(' + scale + ')';

    const dx = (Math.random() * 2 - 1) * 40;
    const dy = -10 - Math.random() * 40;
    const dur = 600 + Math.random() * 600;
    const start = performance.now();

    function anim(now){
      const p = (now - start) / dur;
      if (p >= 1) { s.remove(); return; }
      s.style.left = (rect.left + x + dx * p) + 'px';
      s.style.top = (rect.top + y + dy * p) + 'px';
      s.style.opacity = String(1 - p);
      requestAnimationFrame(anim);
    }
    requestAnimationFrame(anim);
  }

  function burstConfetti(){
    const card = document.querySelector('.card');
    const rect = card ? card.getBoundingClientRect() : { left: window.innerWidth/2, top: window.innerHeight/2, width: 240, height: 160 };
    const cx = rect.left + rect.width / 2;
    const cy = rect.top + rect.height / 2;
    const count = 18;

    for (let i = 0; i < count; i++){
      const c = document.createElement('div');
      c.className = 'confetti-piece';
      c.style.position = 'fixed';
      c.style.left = cx + 'px';
      c.style.top = cy + 'px';
      c.style.width = '8px';
      c.style.height = '12px';
      c.style.opacity = '1';
      particlesRoot.appendChild(c);

      c.style.background = (Math.random() > 0.5) ? 'linear-gradient(180deg,#29a1ff,#0f3b8c)' : 'linear-gradient(180deg,#7ef2b3,#2fca8a)';

      const angle = Math.random() * Math.PI * 2;
      const speed = 120 + Math.random() * 260;
      const rot = (Math.random() * 360);
      const dur = 800 + Math.random() * 800;
      const start = performance.now();

      function anim(now){
        const p = (now - start) / dur;
        if (p >= 1) { c.remove(); return; }
        const vx = Math.cos(angle) * speed * p;
        const vy = Math.sin(angle) * speed * p - 80 * p * p;
        c.style.left = (cx + vx) + 'px';
        c.style.top = (cy + vy) + 'px';
        c.style.transform = 'rotate(' + (rot + p * 720) + 'deg)';
        c.style.opacity = String(1 - p);
        requestAnimationFrame(anim);
      }
      requestAnimationFrame(anim);
    }
  }

  // Подключаем обработчик безопасно (элемент гарантированно существует, т.к. мы в DOMContentLoaded)
  btn.addEventListener('click', startGeneration);

  // Инициализация отображения: всегда 0 x
  display.textContent = '0 x';
  meter.style.width = '0%';
  particlesRoot.style.position = 'fixed';
  particlesRoot.style.left = 0;
  particlesRoot.style.top = 0;
  particlesRoot.style.width = '100%';
  particlesRoot.style.height = '100%';
  particlesRoot.style.pointerEvents = 'none';
});

document.addEventListener("DOMContentLoaded", () => {
  const btnAmountEl = document.getElementById("abwBtnAmount");
  const placeBtn = document.getElementById("abwPlaceBtn");

  let amount = 0.10;     // стартовое значение
  const step = 0.01;     // шаг для +/-
  // лимиты для каждой валюты
  const currencyLimits = {
    EUR: { min: 0.01, max: 200 },
    RUB: { min: 10, max: 16500 },
    USD: { min: 0.01, max: 230 },
    KZT: { min: 20, max: 110000 }
  };
  function getCurrentCurrency() {
    const curBtn = document.querySelector('.currency-btn[style*="linear-gradient"]');
    if (curBtn) return curBtn.dataset.currency;
    return 'EUR';
  }
  function getLimits() {
    const cur = getCurrentCurrency();
    return currencyLimits[cur] || currencyLimits['EUR'];
  }

  // функция обновления UI
  function updateAmount() {
    if (btnAmountEl) btnAmountEl.textContent = amount.toFixed(2);
    // Синхронизируем поле ввода и min/max
    const abwInput = document.getElementById('abwInput');
    if (abwInput) {
      abwInput.value = amount.toFixed(2);
      const { min, max } = getLimits();
      abwInput.min = min;
      abwInput.max = max;
    }
    // Синхронизируем выделение чипов
    const abwPresets = document.querySelector('.abw-presets');
    if (abwPresets) {
      abwPresets.querySelectorAll('.abw-chip').forEach(b => {
        if (parseFloat(b.dataset.value) === parseFloat(amount)) {
          b.classList.add('active');
        } else {
          b.classList.remove('active');
        }
      });
    }
  }

  // кнопки +/-
  document.querySelectorAll(".abw-circle").forEach(btn => {
    btn.addEventListener("click", () => {
      const action = btn.dataset.action;
      const { min, max } = getLimits();
      if (action === "plus") {
        amount = Math.min(max, amount + step);
      } else if (action === "minus") {
        amount = Math.max(min, amount - step);
      }
      updateAmount();
    });
  });


  // --- Динамические пресеты для каждой валюты ---
  const presetMap = {
    EUR: [0.01, 0.10, 0.50, 1, 5, 10],
    RUB: [1, 10, 50, 100, 500, 1000],
    USD: [0.011, 0.120, 0.6, 1.20, 6, 12],
    KZT: [6, 65, 350, 650, 3250, 6500]
  };

  function renderChips(cur) {
    const abwPresets = document.querySelector('.abw-presets');
    if (!abwPresets) return;
    abwPresets.innerHTML = '';
    const currentAmount = amount;
    const { min, max } = currencyLimits[cur] || currencyLimits['EUR'];
    (presetMap[cur] || presetMap['EUR']).forEach(val => {
      const btn = document.createElement('button');
      btn.className = 'abw-chip';
      btn.setAttribute('data-value', val);
      btn.textContent = (val % 1 === 0) ? val : val.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 3});
      // Если текущее значение совпадает — выделяем
      if (parseFloat(val) === parseFloat(currentAmount)) btn.classList.add('active');
      btn.addEventListener('click', () => {
        amount = parseFloat(val);
        // Ограничиваем по min/max для валюты
        if (amount < min) amount = min;
        if (amount > max) amount = max;
        updateAmount();
        // Снять выделение со всех чипов и выделить текущий
        abwPresets.querySelectorAll('.abw-chip').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
      });
      abwPresets.appendChild(btn);
    });
  }

  // При инициализации и смене валюты — обновлять чипы
  function updateChipsForCurrency() {
    const cur = (typeof getCurrency === 'function') ? getCurrency() : 'EUR';
    const { min, max } = currencyLimits[cur] || currencyLimits['EUR'];
    // Если текущее значение вне диапазона — выставить минимальное
    if (amount < min) amount = min;
    if (amount > max) amount = max;
    renderChips(cur);
    updateAmount();
  }

  // Первичная отрисовка
  updateChipsForCurrency();

    // кнопка "Ставка"
    placeBtn.addEventListener("click", () => {
        alert(`Ставка сделана`);
        // тут можно отправить данные на сервер или запустить игру
    });

  updateAmount(); // инициализация

  // При смене валюты обновлять чипы
  document.querySelectorAll('.currency-btn').forEach(btn => {
    btn.addEventListener('click', updateChipsForCurrency);
  });
    // Обработчик: при нажатии Enter в поле ввода ставки синхронизируем переменную amount и UI
    const abwInput = document.getElementById('abwInput');
  if (abwInput) {
    abwInput.addEventListener('keydown', (e) => {
      if (e.key === 'Enter') {
        const raw = abwInput.value;
        if (raw === '') return; // ничего не делаем на пустом вводе
        let n = parseFloat(String(raw).replace(',', '.'));
        if (isNaN(n)) return;
        const { min, max } = getLimits();
        if (n < min) n = min;
        if (n > max) n = max;
        amount = Math.round(n * 100) / 100;
        updateAmount();
        abwInput.value = amount.toFixed(2);
      }
    });
  }
});


// Функция для перевода кнопки СТАРТ
function getStartBtnText() {
  const langRaw = localStorage.getItem('vavada_lang') || 'RUS';
  const lang = langRaw === 'KZT' ? 'KAZ' : langRaw;
  const startKey = 'СТАРТ';
  if (typeof translations !== 'undefined' && translations[lang] && translations[lang][startKey]) {
    return translations[lang][startKey];
  }
  if (lang === 'ENG') return 'START';
  if (lang === 'KAZ') return 'БАСТАУ';
  return startKey;
}

// Функция для перевода кнопки ОТМЕНИТЬ
function getCancelBtnText() {
  const langRaw = localStorage.getItem('vavada_lang') || 'RUS';
  const lang = langRaw === 'KZT' ? 'KAZ' : langRaw;
  const cancelKey = 'ОТМЕНИТЬ';
  if (typeof translations !== 'undefined' && translations[lang] && translations[lang][cancelKey]) {
    return translations[lang][cancelKey];
  }
  if (lang === 'ENG') return 'CANCEL';
  if (lang === 'KAZ') return 'БАС ТАРТУ';
  return cancelKey;
}

// Находим кнопку "Далее"
const nextBtn = document.getElementById("nextBtn");




nextBtn.addEventListener("click", () => {
  // Переход к шагу 4 (Aviator — вкладка 2)
  if (typeof showStep === 'function') {
    showStep(4);
  } else {
    // fallback: скрыть все шаги и показать step-4 вручную
    document.querySelectorAll('.step').forEach(s => s.classList.remove('active'));
    const s4 = document.getElementById('step-4');
    if (s4) s4.classList.add('active');
    // и активировать dot-4
    document.querySelectorAll('.step-dot').forEach(d => d.classList.remove('active'));
    const d4 = document.getElementById('dot-4');
    if (d4) d4.classList.add('active');
  }
  
});

  </script>
</body>

</html>
